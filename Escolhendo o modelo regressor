{
 "cells": [
  {
   "attachments": {},
   "cell_type": "markdown",
   "id": "275d0210-e024-4794-91c4-9b3a543c6926",
   "metadata": {},
   "source": [
    "\n",
    "\n",
    "Estudando os melhores atributos e hiperparâmetros do regressor e a escolha pelo de floresta aleatória\n",
    "==================="
   ]
  },
  {
   "cell_type": "markdown",
   "id": "731611d9-ecd3-4904-ab05-6f31d4f2659d",
   "metadata": {},
   "source": [
    "### Autores: Glauber Nascimento, Rafael Anis, Maria Emily Gomes"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "035867a4-5d6f-4ff7-98d9-0e07d64afc3e",
   "metadata": {},
   "source": [
    "<p style=\"text-align:justify;\"> Nesse notebook, utilizou-se o banco de dados $MSK MetTropism$, o qual foi produzido e estudado pelo grupo o qual publicou \"Genomic characterization of metastatic patterns from prospective clinical sequencing of 25,000 patients\". Nosso projeto, no entanto, irá utilizar essa vasta informação e tentar predizer o tempo de sobrevida de pacientes de <strong>Câncer de pulmão de células não pequenas</strong>. E, nesse notebook, a itenção é contar como que alcançamos nossos resultados e o porquê de ter escolhido o regressor de floresta aleatória. Esse modelo pretende discutir o tempo de sobrevida de pacientes que não foram previstos como curados, ou seja, apresentaram um tempo de sobrevida maior que 60 meses no <strong>modelo classificador</strong>.\n",
    "\n",
    "<p style=\"text-align:justify;\"> Para conseguir os melhores resultados, não só especificamos um tipo de câncer para treinar o modelo, como também escolhemos dois focos de estudos: <strong>modelo de floresta aleatória</strong> e o <strong>modelo KNN</strong> e dividimos as observações do dataset em dados de treino e de teste para verificar a performance. Além disso, houve um estudo acerca dos melhores atributos - assim como verificamos se havia multicolinearidade associada às coluna, dos melhores parâmetros com o optuna e, assim, espera-se um RMSE baixo, a modo que os resultados se mostrem relevantes. Para haver um métrica que nos possibilite obter uma sensibilidade de como está a qualidade dos modelos, iremos obter o RMSE de um modelo baseline. Então, como o RMSE do modelo de floresta aleatória foi menor que a do baseline e a do KNN, o trabalho apresentará discussões de como alcançou o resultado e como poderia aprimorá-lo."
   ]
  },
  {
   "cell_type": "markdown",
   "id": "890ade76-d779-4d69-8f14-77c54a208a12",
   "metadata": {},
   "source": [
    "### Importando as bibliotecas "
   ]
  },
  {
   "cell_type": "markdown",
   "id": "8877e1d2-da4c-413c-9271-a01f0bd60549",
   "metadata": {},
   "source": [
    "<p style=\"text-align:justify;\">  A biblioteca <strong>pandas</strong> será necessária para ler e editar o dataframe utilizado neste trabalho e a <strong>numpy</strong> para realizar operações como atribuir um valor <strong>NaN</strong> em uma nova coluna. "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 1,
   "id": "2a13fab8-2c52-4d8a-a922-e8ba13e80a21",
   "metadata": {},
   "outputs": [],
   "source": [
    "import pandas as pd\n",
    "import numpy as np"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "b2a7b01a-638b-4252-bd87-28e454675eaf",
   "metadata": {},
   "source": [
    "### Leitura do dataset"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "b1363b09-a9a1-4c25-845b-bafd85ed7388",
   "metadata": {},
   "source": [
    "<p style=\"text-align:justify;\"> O dataset a seguir é de onde foi realizada todas as operações necessárias para desenvolver os modelos. O primeiro foco do grupo foi encontrar os atributos relevantes para o objetivo, como também encontrar uma coluna de target adequada para a nossa discussão."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "id": "d638d23d-6027-4a86-9ac2-fc38223473a6",
   "metadata": {},
   "outputs": [],
   "source": [
    "df = pd.read_csv(\"msk_met_2021_clinical_data (1).tsv\", sep = \"\\t\")"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "f8856102-1113-4ac0-bf96-c22e6b475263",
   "metadata": {},
   "source": [
    "<p style=\"text-align:justify;\"> Em seguida, discutiu-se acerca da coluna de target, pois a sobrevida encontrada no dataset não era coerente ao dado que precisávamos para a predição. Então, a seguir, será observado como resolvemos o empasse, assim como o estudo em <strong>Trantando o Target</strong> mostra os tais problemas e o raciocínio detalhado para resolvé-lo. Em resumo, teremos uma coluna de sobrevida que avalia o tempo entre o <strong>sequenciamento genômico do paciente até o mês que foi identificado a sua morte.</strong> Contudo, produzir um modelo que prediz um tempo de vida maior que 60 meses não é pertinente, pois o tempo que observa-se um paciente de câncer é até 60 meses. Nesse sentido informar uma sobrevida de 60 ou, por exemplo, 80 meses implica na mesma situação: o paciente estará curado com os atributos que possui. "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "id": "aafd09da-ebba-4569-96ee-574ce5502534",
   "metadata": {},
   "outputs": [],
   "source": [
    "df['Curado'] = pd.NA\n",
    "df ['Sobrevivencia (Meses)'] = pd.NA\n",
    "\n",
    "for i, meses in enumerate(df['Overall Survival (Months)']):\n",
    "    \n",
    "    if meses >= 60:\n",
    "        df.loc [i, 'Curado'] = 1\n",
    "        \n",
    "    else:\n",
    "        if df.loc [i, 'Overall Survival Status'] == '1:DECEASED':\n",
    "            df.loc [i, 'Curado'] = 0\n",
    "            df.loc [i, 'Sobrevivencia (Meses)'] = meses"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "c0683088-2c6c-4d04-9e3e-3d9ca10f807c",
   "metadata": {},
   "source": [
    "<p style=\"text-align:justify;\"> Para minimizar o RMSE, optamos por selecionar um câncer específico do dataset. Considerando que o Câncer de pulmão de células não pequenas é o que apresenta a maior quantidade de observações, a predição da sobrevida de pacientes com esse tipo de câncer foi a selecionada para ser o objeto de estudo. Assim, o foco foi a busca por um modelo de baixo viés. "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "id": "e4c7af2e-91df-467b-9110-3d14d55e2e1a",
   "metadata": {},
   "outputs": [],
   "source": [
    "df = df.loc[df[\"Cancer Type\"] == \"Non-Small Cell Lung Cancer\"]"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "b2174b7c-da18-4c94-98cd-b7497b533ef2",
   "metadata": {},
   "source": [
    "#### Separando as colunas pertinentes para o modelo em atributos e target"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "bba74045-1032-468b-ad87-ee87fed0e05d",
   "metadata": {},
   "source": [
    "<p style=\"text-align:justify;\"> Usaremos para o modelo atributos como o <strong>Fraction Genome Altered</strong>, o qual é a razão entre a soma dos segmentos do genoma que foram alterados pele tamanho total do genoma do paciente, esse resultado é bastante relevante para identificar o quão instável está o tumor e, desse modo, saber como está a sua progressão. Há também atributos que conseguem identificar a situação metastática do câncer a partir das informações genômicas, pois há como identificar uma hipermutação, MSI-High (MSI-H),  a partir do <strong>MSI Score</strong>, Microsatellite instability, a instabilidade de microssatélites, ou para a quantidade de mutações, informação essa que pode ser encontrada na coluna <strong>Mutation Count</strong>. O <strong>TMB (nonsynonymous)</strong>, tumor mutational burden, quantifica o número total de mutações encontradas no DNA do tumor e é considerado alto para valores maior que 10 mut/Mb, o que foi bastante encontrado em pacientes com adenocarcinoma de pulmão. A <strong>Age at Surgical Procedure</strong>, idade da operação cirúrgica, é relavante para qualquer paciente, pois, com idades distintas, os pacientes apresentam resposta à mesma operação de forma diferente. E, considerando a relevante relação entre quantidade de metátases e a sobrevida, iremos utilizar também os atributos <strong>Met Count</strong> e <strong>Met Site Count</strong>, que, respectivamente, são a quantidade de metástases e a quantidade de sítios de metástases."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "id": "776e0d21-8b45-4c35-bbd0-4fa67b3576b3",
   "metadata": {},
   "outputs": [],
   "source": [
    "ATRIBUTOS = [                  \n",
    "        \"Age at Surgical Procedure\",           \n",
    "        \"Fraction Genome Altered\",              \n",
    "        \"Met Count\",                            \n",
    "        \"Met Site Count\",                       \n",
    "        \"MSI Score\",                   \n",
    "        \"Mutation Count\",              \n",
    "        \"TMB (nonsynonymous)\"]         \n",
    "TARGET = [\"Sobrevivencia (Meses)\"]"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "3148bafd-dde2-4450-9e32-4ad4594b49fa",
   "metadata": {},
   "source": [
    "#### Encontrando o dataset com os dados que serão utilizados"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "8f1a10d4-e510-4cc5-b352-38d819332e5e",
   "metadata": {},
   "source": [
    "<p style=\"text-align:justify;\"> O dataset a seguir é o tratado, no caso, há apenas pacientes que tiveram um sobrevida menor que 60 meses, as colunas selecionadas nos debates anteriores, há a eliminação de colunas que não apresentam valores e também há a conversão dos valores. "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 6,
   "id": "5e7ba154-0398-4da1-b108-40df70d3a5a4",
   "metadata": {},
   "outputs": [],
   "source": [
    "df = df.loc[df[\"Curado\"] == 0]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 7,
   "id": "874ed84b-ab75-405e-93a2-81e7d016e1d1",
   "metadata": {},
   "outputs": [],
   "source": [
    "df = df.reindex(ATRIBUTOS + TARGET, axis=1)\n",
    "df = df.dropna()\n",
    "df = df.convert_dtypes()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 8,
   "id": "a3aeff23-ce6e-4d2a-9eea-1f4077b36898",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Age at Surgical Procedure</th>\n",
       "      <th>Fraction Genome Altered</th>\n",
       "      <th>Met Count</th>\n",
       "      <th>Met Site Count</th>\n",
       "      <th>MSI Score</th>\n",
       "      <th>Mutation Count</th>\n",
       "      <th>TMB (nonsynonymous)</th>\n",
       "      <th>Sobrevivencia (Meses)</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>44</th>\n",
       "      <td>71.17</td>\n",
       "      <td>0.2474</td>\n",
       "      <td>4</td>\n",
       "      <td>4</td>\n",
       "      <td>0.44</td>\n",
       "      <td>15</td>\n",
       "      <td>16.63733</td>\n",
       "      <td>47.9</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>60</th>\n",
       "      <td>79.31</td>\n",
       "      <td>0.0026</td>\n",
       "      <td>7</td>\n",
       "      <td>7</td>\n",
       "      <td>0.0</td>\n",
       "      <td>4</td>\n",
       "      <td>4.436621</td>\n",
       "      <td>19.58</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>69</th>\n",
       "      <td>50.73</td>\n",
       "      <td>0.4502</td>\n",
       "      <td>8</td>\n",
       "      <td>8</td>\n",
       "      <td>3.36</td>\n",
       "      <td>5</td>\n",
       "      <td>4.436621</td>\n",
       "      <td>18.73</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>79</th>\n",
       "      <td>37.69</td>\n",
       "      <td>0.3584</td>\n",
       "      <td>4</td>\n",
       "      <td>4</td>\n",
       "      <td>0.93</td>\n",
       "      <td>3</td>\n",
       "      <td>3.327466</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>105</th>\n",
       "      <td>69.42</td>\n",
       "      <td>0.4041</td>\n",
       "      <td>7</td>\n",
       "      <td>7</td>\n",
       "      <td>1.33</td>\n",
       "      <td>3</td>\n",
       "      <td>2.936159</td>\n",
       "      <td>13.21</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>25485</th>\n",
       "      <td>63.46</td>\n",
       "      <td>0.2645</td>\n",
       "      <td>4</td>\n",
       "      <td>4</td>\n",
       "      <td>0.18</td>\n",
       "      <td>10</td>\n",
       "      <td>8.646981</td>\n",
       "      <td>1.31</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>25508</th>\n",
       "      <td>67.29</td>\n",
       "      <td>0.5715</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>0.43</td>\n",
       "      <td>19</td>\n",
       "      <td>16.429264</td>\n",
       "      <td>0.66</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>25535</th>\n",
       "      <td>55.57</td>\n",
       "      <td>0.1114</td>\n",
       "      <td>11</td>\n",
       "      <td>8</td>\n",
       "      <td>0.29</td>\n",
       "      <td>4</td>\n",
       "      <td>3.458792</td>\n",
       "      <td>8.51</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>25536</th>\n",
       "      <td>61.42</td>\n",
       "      <td>0.1031</td>\n",
       "      <td>3</td>\n",
       "      <td>3</td>\n",
       "      <td>0.05</td>\n",
       "      <td>1</td>\n",
       "      <td>0.864698</td>\n",
       "      <td>10.87</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>25620</th>\n",
       "      <td>65.08</td>\n",
       "      <td>0.3406</td>\n",
       "      <td>4</td>\n",
       "      <td>3</td>\n",
       "      <td>0.05</td>\n",
       "      <td>6</td>\n",
       "      <td>5.188189</td>\n",
       "      <td>10.91</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>1931 rows × 8 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "       Age at Surgical Procedure  Fraction Genome Altered  Met Count  \\\n",
       "44                         71.17                   0.2474          4   \n",
       "60                         79.31                   0.0026          7   \n",
       "69                         50.73                   0.4502          8   \n",
       "79                         37.69                   0.3584          4   \n",
       "105                        69.42                   0.4041          7   \n",
       "...                          ...                      ...        ...   \n",
       "25485                      63.46                   0.2645          4   \n",
       "25508                      67.29                   0.5715          1   \n",
       "25535                      55.57                   0.1114         11   \n",
       "25536                      61.42                   0.1031          3   \n",
       "25620                      65.08                   0.3406          4   \n",
       "\n",
       "       Met Site Count  MSI Score  Mutation Count  TMB (nonsynonymous)  \\\n",
       "44                  4       0.44              15             16.63733   \n",
       "60                  7        0.0               4             4.436621   \n",
       "69                  8       3.36               5             4.436621   \n",
       "79                  4       0.93               3             3.327466   \n",
       "105                 7       1.33               3             2.936159   \n",
       "...               ...        ...             ...                  ...   \n",
       "25485               4       0.18              10             8.646981   \n",
       "25508               1       0.43              19            16.429264   \n",
       "25535               8       0.29               4             3.458792   \n",
       "25536               3       0.05               1             0.864698   \n",
       "25620               3       0.05               6             5.188189   \n",
       "\n",
       "       Sobrevivencia (Meses)  \n",
       "44                      47.9  \n",
       "60                     19.58  \n",
       "69                     18.73  \n",
       "79                       0.0  \n",
       "105                    13.21  \n",
       "...                      ...  \n",
       "25485                   1.31  \n",
       "25508                   0.66  \n",
       "25535                   8.51  \n",
       "25536                  10.87  \n",
       "25620                  10.91  \n",
       "\n",
       "[1931 rows x 8 columns]"
      ]
     },
     "execution_count": 8,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "37ddec05-349c-4dfc-a302-a980c285cab1",
   "metadata": {},
   "source": [
    "<p style=\"text-align:justify;\"> Estudando o artigo de referência que disponibilou o dataset utilizado para encontrar o modelo que melhor descreve a sobrevida de um paciente de câncer de pulmão de células não pequenas,$\\textit{Non-Small Cell Lung}$, separou-se as colunas de atributos mostradas no tópico anterior. Contudo, para evitar um custo computacional desnecessário, será selecionado atributos que não apresentem multicolinearidade, ou seja, não é possível com uma combinação linear de atributos prever um outro. Isso será realizado com a seleção de atributos pelo fator de inflação de variância (VIF), desse modo, evita-se dados redundantes e cada operação realizada pelo modelo será relevante para encontrar o targer proposto.  \n",
    "\n",
    "<p style=\"text-align:justify;\"><strong>Antes de começar a gerar os modelos, vale notar que o modelo regressor não tem erro associado do modelo classificador, pois os dados que foram treinados nesse notebook não são os que ele apontou como não curados, são os pacientes do dataset original que apresentaram uma sobrevida de até 60 meses.</strong>"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "f89fb9ad-99b8-4568-a729-a3dc2a5a0ddc",
   "metadata": {},
   "source": [
    "#### Separando dados de treino e teste"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "834d322d-281b-4b52-86cc-4132de579b47",
   "metadata": {},
   "source": [
    "<p style=\"text-align:justify;\"> Separa-se dados de treino e de teste para avaliar a performance do trabalho desenvolvido. Mesmo com o tratamento de dados utilizados, ainda há muitos dados para serem utilizados, desse modo, mostra-se suficiente um teste que represente 10% das observações que o dataset base para o modelo possui."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 9,
   "id": "88c34c0f-5b13-408c-9a7f-7aabd5ada7fc",
   "metadata": {},
   "outputs": [],
   "source": [
    "from sklearn.model_selection import train_test_split\n",
    "\n",
    "TAMANHO_TESTE = 0.1\n",
    "SEMENTE_ALEATORIA = 61455\n",
    "\n",
    "indices = df.index\n",
    "indices_treino, indices_teste = train_test_split(\n",
    "    indices, test_size=TAMANHO_TESTE, random_state=SEMENTE_ALEATORIA\n",
    ")\n",
    "\n",
    "df_treino = df.loc[indices_treino]\n",
    "df_teste = df.loc[indices_teste]\n",
    "\n",
    "X_treino = df_treino.reindex(ATRIBUTOS, axis=1).values\n",
    "y_treino = df_treino.reindex(TARGET, axis=1).values.ravel()\n",
    "\n",
    "X_teste = df_teste.reindex(ATRIBUTOS, axis=1).values\n",
    "y_teste = df_teste.reindex(TARGET, axis=1).values.ravel()"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "542c84f5-cb1f-4547-ae9a-6a33e4cad880",
   "metadata": {},
   "source": [
    "#### Seleção de atributos pelo fator de inflação de variância (VIF)"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "f0ddc838-b3c3-4789-8fde-58675334d8bc",
   "metadata": {},
   "source": [
    "O **fator de inflação de variância** (*variance inflation factor*) é um algoritmo que encontra a multicolinearidade de um conjunto de dados. Os passos a seguir desse código foram descritos pelo professor Daniel Cassar:\n",
    "\n",
    "1.  Escolha o valor do limiar do $\\mathrm{VIF}$.\n",
    "\n",
    "<p>Observação: Escolheu-se o menos rigoroso, valor de limiar 10, pois esses atributos já foram selecionados de acordo com o bom senso para modelar o fenômeno e, ao fim, obtemos poucas colunas. Além disso, após essa etapa, há as operações algébricas que o próprio código realiza, não há mais escolha pensada no nosso problema.</p>\n",
    "   \n",
    "2.  Para cada atributo disponível, considere ele como target e treine um modelo linear com os atributos restantes. Registre o valor $\\mathrm{VIF}$ deste modelo sendo que $\\mathrm{VIF} = 1 / (1 - R^2)$.\n",
    "\n",
    "3.  Se pelo menos um dos valores $\\mathrm{VIF}$ observados no passo 2 for maior que o limiar definido no passo 1, vá ao passo seguinte. Do contrário, encerre o processo.\n",
    "\n",
    "5.  Remova o atributo de maior valor $\\mathrm{VIF}$ e retorne ao passo 2."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 10,
   "id": "df3df8ce-3c29-497e-a58b-b8211b6271a7",
   "metadata": {},
   "outputs": [],
   "source": [
    "from sklearn.ensemble import RandomForestRegressor\n",
    "\n",
    "def selecao_vif(df_atributos, limiar_vif):\n",
    "    \"\"\"Realiza a seleção de atributos por VIF.\n",
    "\n",
    "    Args:\n",
    "      df_atributos: DataFrame contendo os atributos.\n",
    "      limiar_vf: valor do limiar do vif. Número positivo. Usualmente é 5 ou 10.\n",
    "\n",
    "    Returns:\n",
    "      DataFrame com os atributos selecionados.\n",
    "\n",
    "    \"\"\"\n",
    "    df = df_atributos.copy()\n",
    "\n",
    "    while True:\n",
    "        VIFs = []\n",
    "\n",
    "        for col in df.columns:\n",
    "            X = df.drop(col, axis=1).values\n",
    "            y = df[col].values\n",
    "\n",
    "            r_quadrado = RandomForestRegressor().fit(X, y).score(X, y) ##\n",
    "            if r_quadrado != 1:\n",
    "                VIF = 1 / (1 - r_quadrado)\n",
    "            else:\n",
    "                VIF = float(\"inf\")\n",
    "\n",
    "            VIFs.append(VIF)\n",
    "\n",
    "        VIF_maximo = max(VIFs)\n",
    "\n",
    "        if VIF_maximo > limiar_vif:\n",
    "            indice = VIFs.index(VIF_maximo)\n",
    "            coluna_remocao = df.columns[indice]\n",
    "            df = df.drop(coluna_remocao, axis=1)\n",
    "\n",
    "        else:\n",
    "            break\n",
    "\n",
    "    return df"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 11,
   "id": "c94d0baa-1297-4f4d-9474-0f9cf419b8b8",
   "metadata": {},
   "outputs": [],
   "source": [
    "LIMIAR_VIF = 10\n",
    "\n",
    "X_treino = pd.DataFrame(X_treino)\n",
    "X_teste = pd.DataFrame(X_teste)\n",
    "\n",
    "X_treino_modificado = selecao_vif(X_treino, LIMIAR_VIF)\n",
    "X_teste_modificado = X_teste.reindex(X_treino_modificado.columns, axis=1)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 12,
   "id": "e55ef286-bf5c-4927-b352-4c486c88a7e8",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>0</th>\n",
       "      <th>2</th>\n",
       "      <th>4</th>\n",
       "      <th>6</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>87.42</td>\n",
       "      <td>2</td>\n",
       "      <td>0.06</td>\n",
       "      <td>7.782283</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>73.29</td>\n",
       "      <td>3</td>\n",
       "      <td>0.0</td>\n",
       "      <td>3.914879</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>76.24</td>\n",
       "      <td>1</td>\n",
       "      <td>0.0</td>\n",
       "      <td>5.188189</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>80.6</td>\n",
       "      <td>2</td>\n",
       "      <td>0.0</td>\n",
       "      <td>5.872318</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>60.29</td>\n",
       "      <td>2</td>\n",
       "      <td>0.63</td>\n",
       "      <td>17.293962</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1732</th>\n",
       "      <td>31.42</td>\n",
       "      <td>4</td>\n",
       "      <td>3.91</td>\n",
       "      <td>7.764087</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1733</th>\n",
       "      <td>79.18</td>\n",
       "      <td>4</td>\n",
       "      <td>0.15</td>\n",
       "      <td>2.936159</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1734</th>\n",
       "      <td>67.52</td>\n",
       "      <td>6</td>\n",
       "      <td>0.75</td>\n",
       "      <td>5.872318</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1735</th>\n",
       "      <td>79.86</td>\n",
       "      <td>3</td>\n",
       "      <td>7.61</td>\n",
       "      <td>34.587924</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1736</th>\n",
       "      <td>67.78</td>\n",
       "      <td>5</td>\n",
       "      <td>0.97</td>\n",
       "      <td>5.188189</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>1737 rows × 4 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "          0  2     4          6\n",
       "0     87.42  2  0.06   7.782283\n",
       "1     73.29  3   0.0   3.914879\n",
       "2     76.24  1   0.0   5.188189\n",
       "3      80.6  2   0.0   5.872318\n",
       "4     60.29  2  0.63  17.293962\n",
       "...     ... ..   ...        ...\n",
       "1732  31.42  4  3.91   7.764087\n",
       "1733  79.18  4  0.15   2.936159\n",
       "1734  67.52  6  0.75   5.872318\n",
       "1735  79.86  3  7.61  34.587924\n",
       "1736  67.78  5  0.97   5.188189\n",
       "\n",
       "[1737 rows x 4 columns]"
      ]
     },
     "execution_count": 12,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "X_treino_modificado"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "aca52ab1-c450-4d5f-9fb8-7d3cf9b46cf6",
   "metadata": {},
   "source": [
    "<p style=\"text-align:justify;\"> Escolheu-se o limiar VIF como 10 por ser padrão e conseguiu-se bons resultados com esse valor. Após a eliminação de atributos que apresentavam multicolinearidade, renova-se os atributos. Os que estão comentados são os atributos que não serão mais utilizados."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 13,
   "id": "98f24919-12b3-4b55-b939-9d6ddf005dd1",
   "metadata": {},
   "outputs": [],
   "source": [
    "ATRIBUTOS_VIF = [                  \n",
    "        \"Age at Surgical Procedure\",           \n",
    "        # \"Fraction Genome Altered\",              \n",
    "        \"Met Count\",                            \n",
    "        # \"Met Site Count\",                       \n",
    "        \"MSI Score\",                   \n",
    "        #\"Mutation Count\",              \n",
    "        \"TMB (nonsynonymous)\"\n",
    "]         \n",
    "TARGET = [\"Sobrevivencia (Meses)\"]"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "11acf4c4-8198-40d0-bc8e-a721d6615590",
   "metadata": {},
   "source": [
    "### Modelo Baseline"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "e5746d3f-f3cb-49f9-ab1f-fe657b6803e0",
   "metadata": {},
   "source": [
    "<p style=\"text-align:justify;\"> O modelo baseline para encontrar a sobrevida de pacientes que o primeiro modelo encontrou que não serão curadas pelo caso clínico que apresentam, será para poder obter um RMSE comparativo. O objetivo é verificar se o modelo de floresta aleatória, o qual investiga vários cenários com as suas árvores, consegue, assim, modelar cenários complexos com diversas variáveis, e, então, consiga apresentar um RMSE muito menor, de mesmo modo, o KNN, que observa os vizinhos que apresentaram valores de atributos semlhantes, consiga descrever a realidade de maneira muito melhor que uma média."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 14,
   "id": "67ae0757-5504-40b3-a20a-18541f02d568",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "[14.22521491 14.22521491 14.22521491 ... 14.22521491 14.22521491\n",
      " 14.22521491]\n"
     ]
    }
   ],
   "source": [
    "from sklearn.dummy import DummyRegressor\n",
    "\n",
    "x = df.reindex(ATRIBUTOS_VIF, axis=1)\n",
    "y = df.reindex(TARGET, axis=1)\n",
    "\n",
    "modelo = DummyRegressor()\n",
    "\n",
    "modelo.fit(x, y)\n",
    "\n",
    "y_previsto = modelo.predict(x)\n",
    "\n",
    "print(y_previsto)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 15,
   "id": "3beaa911-22fe-40f6-af7a-4b5b57685ba8",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "O RMSE foi de: 12.420902597184595\n"
     ]
    }
   ],
   "source": [
    "from sklearn.metrics import mean_squared_error\n",
    "\n",
    "y_verdadeiro = y\n",
    "\n",
    "RMSE = mean_squared_error(y_verdadeiro, y_previsto, squared = False)\n",
    "\n",
    "print(f\"O RMSE foi de: {RMSE}\")"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "8e68fafd-b568-4d53-9385-fe37dfb3bf18",
   "metadata": {},
   "source": [
    "<p style=\"text-align:justify;\"> Agora que há uma métrica para o baseline, modelo mais simples possível para prever o target, começa-se utilizar técnicas, como ao selecionar os melhores hiperparâmetros de modo que minimize ao máximo o valor do RMSE. \n",
    "<p>\n"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "7d435f2a-f018-4fe4-95fc-767830b8b9bd",
   "metadata": {},
   "source": [
    "## Otimizando hiperparâmetros com o optuna para o regressor de floresta aleatória"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "b50f1ef9-c1ac-4348-94dc-a496274389c7",
   "metadata": {},
   "source": [
    "<p style=\"text-align:justify;\"> Encontrando o melhor conjunto de hiperparâmetros com o optuna. Esta seleção será realizada com o novo dataset que não apresenta mais multicolinearidade em seus dados, desse modo o esperado é encontrar um bom conjunto de hiperparâmetros de modo menos custoso computacionalmente.\n",
    "\n",
    "#### Separando dados de treino e teste"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 16,
   "id": "56e11425-b136-4b86-ab96-e8d556814a2b",
   "metadata": {},
   "outputs": [],
   "source": [
    "from sklearn.model_selection import train_test_split\n",
    "\n",
    "TAMANHO_TESTE = 0.1\n",
    "SEMENTE_ALEATORIA = 20404\n",
    "\n",
    "df = df.reindex(ATRIBUTOS_VIF + TARGET, axis=1)\n",
    "df = df.dropna()\n",
    "\n",
    "indices = df.index\n",
    "indices_treino, indices_teste = train_test_split(\n",
    "    indices, test_size=TAMANHO_TESTE, random_state=SEMENTE_ALEATORIA\n",
    ")\n",
    "\n",
    "df_treino = df.loc[indices_treino]\n",
    "df_teste = df.loc[indices_teste]\n",
    "\n",
    "X_treino = df_treino.reindex(ATRIBUTOS_VIF, axis=1).values\n",
    "y_treino = df_treino.reindex(TARGET, axis=1).values.ravel()\n",
    "\n",
    "X_teste = df_teste.reindex(ATRIBUTOS_VIF, axis=1).values\n",
    "y_teste = df_teste.reindex(TARGET, axis=1).values.ravel()\n",
    "\n",
    "X = df.reindex(ATRIBUTOS_VIF, axis=1).values\n",
    "y = df.reindex(TARGET, axis=1).values.ravel()"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "cbbd5608-985b-48c4-82cd-2bee6834f25b",
   "metadata": {},
   "source": [
    "#### Delimitando o espaço de busca "
   ]
  },
  {
   "cell_type": "markdown",
   "id": "895387ae-97a9-4075-9c0a-c493118a9b62",
   "metadata": {},
   "source": [
    "<p style=\"text-align:justify;\"> Inicialmente, o espaço de busca era longo e o optuna era realizado várias vezes. Isso serviu de base para entender por onde o optuna estava encontrando os melhores conjuntos e, com essa informação, houve a busca a seguir perto dos valores com os melhores resultados para cada hiperparâmetro."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 17,
   "id": "c3bd9fb6-aa97-4a9e-b1fa-23242d7daedb",
   "metadata": {},
   "outputs": [],
   "source": [
    "from sklearn.ensemble import RandomForestRegressor\n",
    "\n",
    "def cria_instancia_modelo(trial):\n",
    "    \"\"\"Cria uma instância do modelo.\n",
    "\n",
    "    Args:\n",
    "      trial: objeto tipo Trial do optuna.\n",
    "\n",
    "    Returns:\n",
    "      Uma instância do modelo desejado.\n",
    "\n",
    "    \"\"\"\n",
    "    parametros = {\n",
    "        \"n_estimators\": trial.suggest_int(\"num_arvores\", 10, 500),\n",
    "        \"criterion\": trial.suggest_categorical(\n",
    "            \"critério\", [\"squared_error\", \"friedman_mse\", \"poisson\"]\n",
    "        ),\n",
    "        \"min_samples_split\": trial.suggest_int(\n",
    "            \"min_exemplos_split\", 2, 50, log=True\n",
    "        ),\n",
    "        \"min_samples_leaf\": trial.suggest_int(\n",
    "            \"min_exemplos_folha\", 1, 100, log=True\n",
    "        ),\n",
    "        \"max_features\": trial.suggest_float(\"num_max_atributos\", 0, 1),\n",
    "        \"n_jobs\": -1,\n",
    "        \"bootstrap\": True,\n",
    "        \"random_state\": SEMENTE_ALEATORIA\n",
    "    }\n",
    "\n",
    "    model = RandomForestRegressor(**parametros)\n",
    "\n",
    "    return model"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "6e9967da-26bb-449f-83dc-70293d3a70a8",
   "metadata": {},
   "source": [
    "#### Função objetivo"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "27fe6305-e56a-42ce-abd3-e1840602de4d",
   "metadata": {},
   "source": [
    "<p style=\"text-align:justify;\"> A função objetivo de um problema de otimização computa métrica de interesse, nesse caso, será o RMSE e, para garantir que aleatoriedade dos dados de teste não influencie tanto no valor encontrado, esse será obtido por validação cruzada. "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 18,
   "id": "bb19b575-7a10-4c8f-8b2c-d2b970c88236",
   "metadata": {},
   "outputs": [],
   "source": [
    "from sklearn.model_selection import cross_val_score\n",
    "\n",
    "def funcao_objetivo(trial, X, y, num_folds):\n",
    "    \"\"\"Função objetivo do optuna\n",
    "\n",
    "    Referencia:\n",
    "      https://medium.com/@walter_sperat/ using-optuna-with-sklearn-the-right-way-part-1-6b4ad0ab2451\n",
    "\n",
    "    \"\"\"\n",
    "    modelo = cria_instancia_modelo(trial)\n",
    "\n",
    "    metricas = cross_val_score(\n",
    "        modelo,\n",
    "        X,\n",
    "        y,\n",
    "        scoring=\"neg_root_mean_squared_error\",\n",
    "        cv=num_folds,\n",
    "    )\n",
    "\n",
    "    return -metricas.mean()"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "5d66abb3-de76-4b98-8f7a-e610c97dd945",
   "metadata": {},
   "source": [
    "#### Otimizando os hiperparâmetros"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "8910126c-88bf-4054-a35e-40909eecc613",
   "metadata": {},
   "source": [
    "<p style=\"text-align:justify;\"> O arquivo <strong>hiperparametros1</strong> guarda o melhor conjunto de hiperparâmetros de todos os estudos realizados nesse notebook para o <strong>regressor de floresta aleatória</strong>."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 19,
   "id": "0f5928df-11e0-445d-9b82-31e9219af10f",
   "metadata": {},
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[I 2024-11-17 12:32:13,480] Using an existing study with name 'hiperparametros1' instead of creating a new one.\n"
     ]
    }
   ],
   "source": [
    "from optuna import create_study\n",
    "\n",
    "NOME_DO_ESTUDO = \"hiperparametros1\"\n",
    "\n",
    "objeto_de_estudo = create_study(\n",
    "    direction=\"minimize\",\n",
    "    study_name=NOME_DO_ESTUDO,\n",
    "    storage=f\"sqlite:///{NOME_DO_ESTUDO}.db\",\n",
    "    load_if_exists=True,\n",
    ")"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "798b389e-0646-4651-9887-606b69303908",
   "metadata": {},
   "source": [
    "#### Função objetivo parcial, uma função objetivo que apresenta apenas o argumento `trial`"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "1ed8b089-24db-4957-8620-e2d2e9a5efd6",
   "metadata": {},
   "source": [
    "<p style=\"text-align:justify;\"> Para conseguir rodar o otimizador, será necessário de uma função objetivo que tenha apenas um argumento, o <strong>trial</strong>. Como a <strong>funcao_objetivo</strong> definida não cumpre com este requisito, defini-se a <strong>funcao_objetivo_parcial`</strong>."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 20,
   "id": "68703bfb-5603-4f80-a0d1-74990e1f7843",
   "metadata": {},
   "outputs": [],
   "source": [
    "NUM_FOLDS = 50\n",
    "\n",
    "def funcao_objetivo_parcial(trial):\n",
    "    return funcao_objetivo(trial, X_treino, y_treino, NUM_FOLDS)"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "a1f91b10-6a34-49ae-a554-ca95c982ce19",
   "metadata": {},
   "source": [
    "#### Define as tentativas e roda o otimizador"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "756c92fa-5973-4341-98e3-83c611204168",
   "metadata": {},
   "source": [
    "<p style=\"text-align:justify;\"> Definiu-se 200 tentativas para encontrar o melhor conjunto de hiperparâmetros e esse notebook foi executado algumas vezes. Então no documento de <strong>hiperparametros1</strong> há centenas de conjuntos de hiperparâmetros avaliados."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 21,
   "id": "0934a712-d695-407c-a21f-bcab6b1c30d4",
   "metadata": {},
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[I 2024-11-17 12:32:25,795] Trial 200 finished with value: 11.932753768478443 and parameters: {'num_arvores': 477, 'critério': 'poisson', 'min_exemplos_split': 41, 'min_exemplos_folha': 8, 'num_max_atributos': 0.44678683680328635}. Best is trial 52 with value: 11.930406468948263.\n",
      "[I 2024-11-17 12:32:36,848] Trial 201 finished with value: 11.931911050495284 and parameters: {'num_arvores': 474, 'critério': 'poisson', 'min_exemplos_split': 41, 'min_exemplos_folha': 10, 'num_max_atributos': 0.4062213782860375}. Best is trial 52 with value: 11.930406468948263.\n",
      "[I 2024-11-17 12:32:48,070] Trial 202 finished with value: 11.932464448057745 and parameters: {'num_arvores': 474, 'critério': 'poisson', 'min_exemplos_split': 41, 'min_exemplos_folha': 8, 'num_max_atributos': 0.44557461174946233}. Best is trial 52 with value: 11.930406468948263.\n",
      "[I 2024-11-17 12:32:59,029] Trial 203 finished with value: 11.932123760085268 and parameters: {'num_arvores': 473, 'critério': 'poisson', 'min_exemplos_split': 41, 'min_exemplos_folha': 8, 'num_max_atributos': 0.4109025897017248}. Best is trial 52 with value: 11.930406468948263.\n",
      "[I 2024-11-17 12:33:09,958] Trial 204 finished with value: 11.932191216115971 and parameters: {'num_arvores': 471, 'critério': 'poisson', 'min_exemplos_split': 40, 'min_exemplos_folha': 8, 'num_max_atributos': 0.4465541014471877}. Best is trial 52 with value: 11.930406468948263.\n",
      "[I 2024-11-17 12:33:21,095] Trial 205 finished with value: 11.932859494241523 and parameters: {'num_arvores': 474, 'critério': 'poisson', 'min_exemplos_split': 40, 'min_exemplos_folha': 8, 'num_max_atributos': 0.4081735487459267}. Best is trial 52 with value: 11.930406468948263.\n",
      "[I 2024-11-17 12:33:32,552] Trial 206 finished with value: 11.934782763988768 and parameters: {'num_arvores': 477, 'critério': 'poisson', 'min_exemplos_split': 38, 'min_exemplos_folha': 8, 'num_max_atributos': 0.4094983980990676}. Best is trial 52 with value: 11.930406468948263.\n",
      "[I 2024-11-17 12:33:43,601] Trial 207 finished with value: 11.932984009435454 and parameters: {'num_arvores': 475, 'critério': 'poisson', 'min_exemplos_split': 39, 'min_exemplos_folha': 8, 'num_max_atributos': 0.4390374263662503}. Best is trial 52 with value: 11.930406468948263.\n",
      "[I 2024-11-17 12:33:54,782] Trial 208 finished with value: 11.93698407921652 and parameters: {'num_arvores': 475, 'critério': 'poisson', 'min_exemplos_split': 39, 'min_exemplos_folha': 9, 'num_max_atributos': 0.44305923642823436}. Best is trial 52 with value: 11.930406468948263.\n",
      "[I 2024-11-17 12:34:05,702] Trial 209 finished with value: 11.93999934534467 and parameters: {'num_arvores': 474, 'critério': 'poisson', 'min_exemplos_split': 43, 'min_exemplos_folha': 8, 'num_max_atributos': 0.40479704986144305}. Best is trial 52 with value: 11.930406468948263.\n",
      "[I 2024-11-17 12:34:16,761] Trial 210 finished with value: 11.937278416270065 and parameters: {'num_arvores': 480, 'critério': 'poisson', 'min_exemplos_split': 40, 'min_exemplos_folha': 9, 'num_max_atributos': 0.440943427026781}. Best is trial 52 with value: 11.930406468948263.\n",
      "[I 2024-11-17 12:34:27,719] Trial 211 finished with value: 11.938828804997023 and parameters: {'num_arvores': 466, 'critério': 'poisson', 'min_exemplos_split': 50, 'min_exemplos_folha': 8, 'num_max_atributos': 0.42894014411930365}. Best is trial 52 with value: 11.930406468948263.\n",
      "[I 2024-11-17 12:34:39,175] Trial 212 finished with value: 11.937602678650302 and parameters: {'num_arvores': 486, 'critério': 'poisson', 'min_exemplos_split': 42, 'min_exemplos_folha': 6, 'num_max_atributos': 0.4202583209457062}. Best is trial 52 with value: 11.930406468948263.\n",
      "[I 2024-11-17 12:34:50,252] Trial 213 finished with value: 11.938923318416677 and parameters: {'num_arvores': 480, 'critério': 'poisson', 'min_exemplos_split': 44, 'min_exemplos_folha': 8, 'num_max_atributos': 0.3926897900252271}. Best is trial 52 with value: 11.930406468948263.\n",
      "[I 2024-11-17 12:35:01,337] Trial 214 finished with value: 11.93650086034343 and parameters: {'num_arvores': 469, 'critério': 'poisson', 'min_exemplos_split': 39, 'min_exemplos_folha': 10, 'num_max_atributos': 0.44542419395917004}. Best is trial 52 with value: 11.930406468948263.\n",
      "[I 2024-11-17 12:35:12,484] Trial 215 finished with value: 11.93284098915718 and parameters: {'num_arvores': 485, 'critério': 'poisson', 'min_exemplos_split': 41, 'min_exemplos_folha': 8, 'num_max_atributos': 0.4040220022907936}. Best is trial 52 with value: 11.930406468948263.\n",
      "[I 2024-11-17 12:35:23,333] Trial 216 finished with value: 11.935322389965325 and parameters: {'num_arvores': 463, 'critério': 'poisson', 'min_exemplos_split': 41, 'min_exemplos_folha': 9, 'num_max_atributos': 0.4062421779591739}. Best is trial 52 with value: 11.930406468948263.\n",
      "[I 2024-11-17 12:35:27,470] Trial 217 finished with value: 11.942146372539703 and parameters: {'num_arvores': 143, 'critério': 'poisson', 'min_exemplos_split': 44, 'min_exemplos_folha': 10, 'num_max_atributos': 0.44141958168019935}. Best is trial 52 with value: 11.930406468948263.\n",
      "[I 2024-11-17 12:35:38,835] Trial 218 finished with value: 11.935168848756819 and parameters: {'num_arvores': 476, 'critério': 'poisson', 'min_exemplos_split': 38, 'min_exemplos_folha': 9, 'num_max_atributos': 0.41792111557423095}. Best is trial 52 with value: 11.930406468948263.\n",
      "[I 2024-11-17 12:35:50,710] Trial 219 finished with value: 11.935450078573226 and parameters: {'num_arvores': 482, 'critério': 'poisson', 'min_exemplos_split': 41, 'min_exemplos_folha': 6, 'num_max_atributos': 0.3908216358855605}. Best is trial 52 with value: 11.930406468948263.\n",
      "[I 2024-11-17 12:36:02,494] Trial 220 finished with value: 11.93493450427373 and parameters: {'num_arvores': 472, 'critério': 'poisson', 'min_exemplos_split': 38, 'min_exemplos_folha': 8, 'num_max_atributos': 0.4453047120153917}. Best is trial 52 with value: 11.930406468948263.\n",
      "[I 2024-11-17 12:36:15,369] Trial 221 finished with value: 11.961446569661511 and parameters: {'num_arvores': 488, 'critério': 'poisson', 'min_exemplos_split': 47, 'min_exemplos_folha': 8, 'num_max_atributos': 0.5017154519775188}. Best is trial 52 with value: 11.930406468948263.\n",
      "[I 2024-11-17 12:36:26,697] Trial 222 finished with value: 11.944517424544856 and parameters: {'num_arvores': 488, 'critério': 'poisson', 'min_exemplos_split': 45, 'min_exemplos_folha': 5, 'num_max_atributos': 0.45262851684006367}. Best is trial 52 with value: 11.930406468948263.\n",
      "[I 2024-11-17 12:36:37,754] Trial 223 finished with value: 11.939936341323321 and parameters: {'num_arvores': 484, 'critério': 'poisson', 'min_exemplos_split': 50, 'min_exemplos_folha': 10, 'num_max_atributos': 0.4218286720511128}. Best is trial 52 with value: 11.930406468948263.\n",
      "[I 2024-11-17 12:36:48,593] Trial 224 finished with value: 11.940362067619041 and parameters: {'num_arvores': 464, 'critério': 'poisson', 'min_exemplos_split': 42, 'min_exemplos_folha': 8, 'num_max_atributos': 0.44985113988125686}. Best is trial 52 with value: 11.930406468948263.\n",
      "[I 2024-11-17 12:36:59,573] Trial 225 finished with value: 11.936533726746761 and parameters: {'num_arvores': 477, 'critério': 'poisson', 'min_exemplos_split': 47, 'min_exemplos_folha': 9, 'num_max_atributos': 0.42362813046841175}. Best is trial 52 with value: 11.930406468948263.\n",
      "[I 2024-11-17 12:37:10,436] Trial 226 finished with value: 11.935512695856207 and parameters: {'num_arvores': 487, 'critério': 'squared_error', 'min_exemplos_split': 41, 'min_exemplos_folha': 7, 'num_max_atributos': 0.382056116206484}. Best is trial 52 with value: 11.930406468948263.\n",
      "[I 2024-11-17 12:37:21,470] Trial 227 finished with value: 11.940062365772608 and parameters: {'num_arvores': 471, 'critério': 'poisson', 'min_exemplos_split': 44, 'min_exemplos_folha': 6, 'num_max_atributos': 0.4863715639081789}. Best is trial 52 with value: 11.930406468948263.\n",
      "[I 2024-11-17 12:37:32,448] Trial 228 finished with value: 11.932871997025552 and parameters: {'num_arvores': 464, 'critério': 'poisson', 'min_exemplos_split': 37, 'min_exemplos_folha': 9, 'num_max_atributos': 0.40155304488281146}. Best is trial 52 with value: 11.930406468948263.\n",
      "[I 2024-11-17 12:37:43,326] Trial 229 finished with value: 11.932276709716337 and parameters: {'num_arvores': 461, 'critério': 'poisson', 'min_exemplos_split': 37, 'min_exemplos_folha': 10, 'num_max_atributos': 0.39642592108742875}. Best is trial 52 with value: 11.930406468948263.\n",
      "[I 2024-11-17 12:37:55,090] Trial 230 finished with value: 11.939875839644237 and parameters: {'num_arvores': 459, 'critério': 'poisson', 'min_exemplos_split': 37, 'min_exemplos_folha': 11, 'num_max_atributos': 0.41148264445847405}. Best is trial 52 with value: 11.930406468948263.\n",
      "[I 2024-11-17 12:38:05,756] Trial 231 finished with value: 11.933894080500309 and parameters: {'num_arvores': 461, 'critério': 'poisson', 'min_exemplos_split': 40, 'min_exemplos_folha': 10, 'num_max_atributos': 0.38871217475984793}. Best is trial 52 with value: 11.930406468948263.\n",
      "[I 2024-11-17 12:38:16,617] Trial 232 finished with value: 11.936135913776633 and parameters: {'num_arvores': 460, 'critério': 'poisson', 'min_exemplos_split': 39, 'min_exemplos_folha': 10, 'num_max_atributos': 0.3914741857797576}. Best is trial 52 with value: 11.930406468948263.\n",
      "[I 2024-11-17 12:38:27,655] Trial 233 finished with value: 11.932994355691482 and parameters: {'num_arvores': 465, 'critério': 'poisson', 'min_exemplos_split': 37, 'min_exemplos_folha': 9, 'num_max_atributos': 0.38076664998428367}. Best is trial 52 with value: 11.930406468948263.\n",
      "[I 2024-11-17 12:38:38,579] Trial 234 finished with value: 11.931841223827737 and parameters: {'num_arvores': 464, 'critério': 'poisson', 'min_exemplos_split': 37, 'min_exemplos_folha': 10, 'num_max_atributos': 0.38196610698530065}. Best is trial 52 with value: 11.930406468948263.\n",
      "[I 2024-11-17 12:38:49,573] Trial 235 finished with value: 11.932099036441285 and parameters: {'num_arvores': 465, 'critério': 'poisson', 'min_exemplos_split': 37, 'min_exemplos_folha': 10, 'num_max_atributos': 0.3885124191284078}. Best is trial 52 with value: 11.930406468948263.\n",
      "[I 2024-11-17 12:39:00,425] Trial 236 finished with value: 11.932540517380424 and parameters: {'num_arvores': 462, 'critério': 'poisson', 'min_exemplos_split': 37, 'min_exemplos_folha': 10, 'num_max_atributos': 0.3862209783057069}. Best is trial 52 with value: 11.930406468948263.\n",
      "[I 2024-11-17 12:39:11,469] Trial 237 finished with value: 11.940355912517038 and parameters: {'num_arvores': 462, 'critério': 'poisson', 'min_exemplos_split': 37, 'min_exemplos_folha': 11, 'num_max_atributos': 0.3758059802880455}. Best is trial 52 with value: 11.930406468948263.\n",
      "[I 2024-11-17 12:39:22,367] Trial 238 finished with value: 11.932276709716337 and parameters: {'num_arvores': 461, 'critério': 'poisson', 'min_exemplos_split': 37, 'min_exemplos_folha': 10, 'num_max_atributos': 0.38828495237979543}. Best is trial 52 with value: 11.930406468948263.\n",
      "[I 2024-11-17 12:39:33,182] Trial 239 finished with value: 11.937601640567273 and parameters: {'num_arvores': 460, 'critério': 'poisson', 'min_exemplos_split': 36, 'min_exemplos_folha': 10, 'num_max_atributos': 0.37769880716863546}. Best is trial 52 with value: 11.930406468948263.\n",
      "[I 2024-11-17 12:39:44,080] Trial 240 finished with value: 11.940355912517038 and parameters: {'num_arvores': 462, 'critério': 'poisson', 'min_exemplos_split': 37, 'min_exemplos_folha': 11, 'num_max_atributos': 0.40431593028430973}. Best is trial 52 with value: 11.930406468948263.\n",
      "[I 2024-11-17 12:39:55,128] Trial 241 finished with value: 11.935712980428296 and parameters: {'num_arvores': 468, 'critério': 'poisson', 'min_exemplos_split': 38, 'min_exemplos_folha': 9, 'num_max_atributos': 0.398569099560176}. Best is trial 52 with value: 11.930406468948263.\n",
      "[I 2024-11-17 12:40:06,180] Trial 242 finished with value: 11.935918575063656 and parameters: {'num_arvores': 471, 'critério': 'poisson', 'min_exemplos_split': 39, 'min_exemplos_folha': 12, 'num_max_atributos': 0.3778126439042223}. Best is trial 52 with value: 11.930406468948263.\n",
      "[I 2024-11-17 12:40:18,210] Trial 243 finished with value: 11.937441045543844 and parameters: {'num_arvores': 455, 'critério': 'poisson', 'min_exemplos_split': 36, 'min_exemplos_folha': 10, 'num_max_atributos': 0.39075877028752126}. Best is trial 52 with value: 11.930406468948263.\n",
      "[I 2024-11-17 12:40:29,358] Trial 244 finished with value: 11.93786603453541 and parameters: {'num_arvores': 472, 'critério': 'poisson', 'min_exemplos_split': 40, 'min_exemplos_folha': 9, 'num_max_atributos': 0.3459447352701369}. Best is trial 52 with value: 11.930406468948263.\n",
      "[I 2024-11-17 12:40:40,225] Trial 245 finished with value: 11.938262282023281 and parameters: {'num_arvores': 461, 'critério': 'poisson', 'min_exemplos_split': 36, 'min_exemplos_folha': 10, 'num_max_atributos': 0.4117198548550621}. Best is trial 52 with value: 11.930406468948263.\n",
      "[I 2024-11-17 12:40:51,158] Trial 246 finished with value: 11.934282545967644 and parameters: {'num_arvores': 472, 'critério': 'poisson', 'min_exemplos_split': 40, 'min_exemplos_folha': 12, 'num_max_atributos': 0.37147360852323513}. Best is trial 52 with value: 11.930406468948263.\n",
      "[I 2024-11-17 12:41:03,199] Trial 247 finished with value: 11.934778083491192 and parameters: {'num_arvores': 456, 'critério': 'poisson', 'min_exemplos_split': 38, 'min_exemplos_folha': 9, 'num_max_atributos': 0.40062219771151875}. Best is trial 52 with value: 11.930406468948263.\n",
      "[I 2024-11-17 12:41:08,821] Trial 248 finished with value: 11.949156248287553 and parameters: {'num_arvores': 200, 'critério': 'poisson', 'min_exemplos_split': 36, 'min_exemplos_folha': 10, 'num_max_atributos': 0.42014906416051934}. Best is trial 52 with value: 11.930406468948263.\n",
      "[I 2024-11-17 12:41:20,167] Trial 249 finished with value: 11.947099715055598 and parameters: {'num_arvores': 474, 'critério': 'poisson', 'min_exemplos_split': 16, 'min_exemplos_folha': 11, 'num_max_atributos': 0.38048716602181193}. Best is trial 52 with value: 11.930406468948263.\n",
      "[I 2024-11-17 12:41:33,130] Trial 250 finished with value: 11.978368445460505 and parameters: {'num_arvores': 466, 'critério': 'poisson', 'min_exemplos_split': 42, 'min_exemplos_folha': 9, 'num_max_atributos': 0.7744232475308319}. Best is trial 52 with value: 11.930406468948263.\n",
      "[I 2024-11-17 12:41:44,835] Trial 251 finished with value: 11.935489647201077 and parameters: {'num_arvores': 447, 'critério': 'poisson', 'min_exemplos_split': 39, 'min_exemplos_folha': 11, 'num_max_atributos': 0.4296556818036374}. Best is trial 52 with value: 11.930406468948263.\n",
      "[I 2024-11-17 12:41:56,049] Trial 252 finished with value: 11.934319494254519 and parameters: {'num_arvores': 477, 'critério': 'poisson', 'min_exemplos_split': 41, 'min_exemplos_folha': 9, 'num_max_atributos': 0.40347486854494335}. Best is trial 52 with value: 11.930406468948263.\n",
      "[I 2024-11-17 12:42:08,116] Trial 253 finished with value: 11.940412276432834 and parameters: {'num_arvores': 459, 'critério': 'poisson', 'min_exemplos_split': 43, 'min_exemplos_folha': 8, 'num_max_atributos': 0.3497429378728266}. Best is trial 52 with value: 11.930406468948263.\n",
      "[I 2024-11-17 12:42:19,113] Trial 254 finished with value: 11.9320116058733 and parameters: {'num_arvores': 468, 'critério': 'poisson', 'min_exemplos_split': 37, 'min_exemplos_folha': 10, 'num_max_atributos': 0.42768277819680217}. Best is trial 52 with value: 11.930406468948263.\n",
      "[I 2024-11-17 12:42:30,600] Trial 255 finished with value: 11.943080316869057 and parameters: {'num_arvores': 443, 'critério': 'poisson', 'min_exemplos_split': 34, 'min_exemplos_folha': 12, 'num_max_atributos': 0.39688002707805126}. Best is trial 52 with value: 11.930406468948263.\n",
      "[I 2024-11-17 12:42:36,915] Trial 256 finished with value: 11.941031919492959 and parameters: {'num_arvores': 217, 'critério': 'poisson', 'min_exemplos_split': 38, 'min_exemplos_folha': 10, 'num_max_atributos': 0.4188784272602357}. Best is trial 52 with value: 11.930406468948263.\n",
      "[I 2024-11-17 12:42:50,381] Trial 257 finished with value: 12.005874737488542 and parameters: {'num_arvores': 467, 'critério': 'poisson', 'min_exemplos_split': 36, 'min_exemplos_folha': 7, 'num_max_atributos': 0.9328773311453169}. Best is trial 52 with value: 11.930406468948263.\n",
      "[I 2024-11-17 12:43:02,300] Trial 258 finished with value: 11.940148037567083 and parameters: {'num_arvores': 458, 'critério': 'poisson', 'min_exemplos_split': 35, 'min_exemplos_folha': 12, 'num_max_atributos': 0.37033654678967615}. Best is trial 52 with value: 11.930406468948263.\n",
      "[I 2024-11-17 12:43:05,392] Trial 259 finished with value: 11.94885781193266 and parameters: {'num_arvores': 96, 'critério': 'squared_error', 'min_exemplos_split': 39, 'min_exemplos_folha': 10, 'num_max_atributos': 0.4282046858244552}. Best is trial 52 with value: 11.930406468948263.\n",
      "[I 2024-11-17 12:43:16,353] Trial 260 finished with value: 11.936036145843259 and parameters: {'num_arvores': 471, 'critério': 'poisson', 'min_exemplos_split': 44, 'min_exemplos_folha': 11, 'num_max_atributos': 0.38790022341842156}. Best is trial 52 with value: 11.930406468948263.\n",
      "[I 2024-11-17 12:43:28,339] Trial 261 finished with value: 11.935545006011955 and parameters: {'num_arvores': 453, 'critério': 'poisson', 'min_exemplos_split': 38, 'min_exemplos_folha': 7, 'num_max_atributos': 0.4084140800399012}. Best is trial 52 with value: 11.930406468948263.\n",
      "[I 2024-11-17 12:43:39,421] Trial 262 finished with value: 11.939775551720546 and parameters: {'num_arvores': 476, 'critério': 'poisson', 'min_exemplos_split': 43, 'min_exemplos_folha': 8, 'num_max_atributos': 0.4389673708734309}. Best is trial 52 with value: 11.930406468948263.\n",
      "[I 2024-11-17 12:43:50,545] Trial 263 finished with value: 11.935963586894216 and parameters: {'num_arvores': 466, 'critério': 'poisson', 'min_exemplos_split': 36, 'min_exemplos_folha': 9, 'num_max_atributos': 0.3657092457556161}. Best is trial 52 with value: 11.930406468948263.\n",
      "[I 2024-11-17 12:43:52,173] Trial 264 finished with value: 11.984558120680738 and parameters: {'num_arvores': 34, 'critério': 'poisson', 'min_exemplos_split': 40, 'min_exemplos_folha': 8, 'num_max_atributos': 0.4189903094665761}. Best is trial 52 with value: 11.930406468948263.\n",
      "[I 2024-11-17 12:44:03,642] Trial 265 finished with value: 11.93979874006742 and parameters: {'num_arvores': 441, 'critério': 'poisson', 'min_exemplos_split': 44, 'min_exemplos_folha': 10, 'num_max_atributos': 0.34325264112846865}. Best is trial 52 with value: 11.930406468948263.\n",
      "[I 2024-11-17 12:44:14,759] Trial 266 finished with value: 11.944558496562314 and parameters: {'num_arvores': 476, 'critério': 'poisson', 'min_exemplos_split': 34, 'min_exemplos_folha': 9, 'num_max_atributos': 0.40402724025870035}. Best is trial 52 with value: 11.930406468948263.\n",
      "[I 2024-11-17 12:44:26,877] Trial 267 finished with value: 11.931290494780832 and parameters: {'num_arvores': 452, 'critério': 'poisson', 'min_exemplos_split': 37, 'min_exemplos_folha': 10, 'num_max_atributos': 0.38198231646860037}. Best is trial 52 with value: 11.930406468948263.\n",
      "[I 2024-11-17 12:44:38,913] Trial 268 finished with value: 11.931290494780832 and parameters: {'num_arvores': 452, 'critério': 'poisson', 'min_exemplos_split': 37, 'min_exemplos_folha': 10, 'num_max_atributos': 0.3873047891356422}. Best is trial 52 with value: 11.930406468948263.\n",
      "[I 2024-11-17 12:44:50,889] Trial 269 finished with value: 11.939159549683424 and parameters: {'num_arvores': 452, 'critério': 'poisson', 'min_exemplos_split': 37, 'min_exemplos_folha': 11, 'num_max_atributos': 0.44584217207525595}. Best is trial 52 with value: 11.930406468948263.\n",
      "[I 2024-11-17 12:45:02,476] Trial 270 finished with value: 11.945231179748815 and parameters: {'num_arvores': 434, 'critério': 'poisson', 'min_exemplos_split': 34, 'min_exemplos_folha': 9, 'num_max_atributos': 0.37185655355195874}. Best is trial 52 with value: 11.930406468948263.\n",
      "[I 2024-11-17 12:45:14,301] Trial 271 finished with value: 11.943298889224165 and parameters: {'num_arvores': 447, 'critério': 'poisson', 'min_exemplos_split': 37, 'min_exemplos_folha': 7, 'num_max_atributos': 0.42295353798200963}. Best is trial 52 with value: 11.930406468948263.\n",
      "[I 2024-11-17 12:45:26,107] Trial 272 finished with value: 11.932699590049456 and parameters: {'num_arvores': 456, 'critério': 'poisson', 'min_exemplos_split': 41, 'min_exemplos_folha': 8, 'num_max_atributos': 0.3911414902724122}. Best is trial 52 with value: 11.930406468948263.\n",
      "[I 2024-11-17 12:45:36,977] Trial 273 finished with value: 11.940362067619041 and parameters: {'num_arvores': 464, 'critério': 'poisson', 'min_exemplos_split': 42, 'min_exemplos_folha': 8, 'num_max_atributos': 0.38907622824376337}. Best is trial 52 with value: 11.930406468948263.\n",
      "[I 2024-11-17 12:45:41,849] Trial 274 finished with value: 11.94515463565908 and parameters: {'num_arvores': 172, 'critério': 'poisson', 'min_exemplos_split': 39, 'min_exemplos_folha': 8, 'num_max_atributos': 0.37463847538219647}. Best is trial 52 with value: 11.930406468948263.\n",
      "[I 2024-11-17 12:45:53,643] Trial 275 finished with value: 11.943012234318939 and parameters: {'num_arvores': 455, 'critério': 'poisson', 'min_exemplos_split': 44, 'min_exemplos_folha': 9, 'num_max_atributos': 0.3332356104703427}. Best is trial 52 with value: 11.930406468948263.\n",
      "[I 2024-11-17 12:46:04,642] Trial 276 finished with value: 11.940585557268564 and parameters: {'num_arvores': 468, 'critério': 'poisson', 'min_exemplos_split': 35, 'min_exemplos_folha': 11, 'num_max_atributos': 0.35704965006357964}. Best is trial 52 with value: 11.930406468948263.\n",
      "[I 2024-11-17 12:46:15,589] Trial 277 finished with value: 11.932805311306463 and parameters: {'num_arvores': 478, 'critério': 'poisson', 'min_exemplos_split': 40, 'min_exemplos_folha': 10, 'num_max_atributos': 0.40493836794031957}. Best is trial 52 with value: 11.930406468948263.\n",
      "[I 2024-11-17 12:46:27,902] Trial 278 finished with value: 11.940096870804163 and parameters: {'num_arvores': 450, 'critério': 'poisson', 'min_exemplos_split': 14, 'min_exemplos_folha': 10, 'num_max_atributos': 0.40425462465256956}. Best is trial 52 with value: 11.930406468948263.\n",
      "[I 2024-11-17 12:46:38,861] Trial 279 finished with value: 11.938095140615442 and parameters: {'num_arvores': 473, 'critério': 'squared_error', 'min_exemplos_split': 38, 'min_exemplos_folha': 8, 'num_max_atributos': 0.39103779046364084}. Best is trial 52 with value: 11.930406468948263.\n",
      "[I 2024-11-17 12:46:49,712] Trial 280 finished with value: 11.938251161177927 and parameters: {'num_arvores': 460, 'critério': 'poisson', 'min_exemplos_split': 32, 'min_exemplos_folha': 12, 'num_max_atributos': 0.4120742610879845}. Best is trial 52 with value: 11.930406468948263.\n",
      "[I 2024-11-17 12:47:01,027] Trial 281 finished with value: 11.937590544313798 and parameters: {'num_arvores': 479, 'critério': 'poisson', 'min_exemplos_split': 40, 'min_exemplos_folha': 6, 'num_max_atributos': 0.3557960748619759}. Best is trial 52 with value: 11.930406468948263.\n",
      "[I 2024-11-17 12:47:11,980] Trial 282 finished with value: 11.938556354315814 and parameters: {'num_arvores': 467, 'critério': 'poisson', 'min_exemplos_split': 36, 'min_exemplos_folha': 10, 'num_max_atributos': 0.3819425497428676}. Best is trial 52 with value: 11.930406468948263.\n",
      "[I 2024-11-17 12:47:23,813] Trial 283 finished with value: 11.937267610978042 and parameters: {'num_arvores': 445, 'critério': 'poisson', 'min_exemplos_split': 45, 'min_exemplos_folha': 7, 'num_max_atributos': 0.4259828765066209}. Best is trial 52 with value: 11.930406468948263.\n",
      "[I 2024-11-17 12:47:34,670] Trial 284 finished with value: 11.934767151762449 and parameters: {'num_arvores': 460, 'critério': 'poisson', 'min_exemplos_split': 42, 'min_exemplos_folha': 11, 'num_max_atributos': 0.4020889890319025}. Best is trial 52 with value: 11.930406468948263.\n",
      "[I 2024-11-17 12:47:42,631] Trial 285 finished with value: 11.928484765389639 and parameters: {'num_arvores': 328, 'critério': 'poisson', 'min_exemplos_split': 33, 'min_exemplos_folha': 10, 'num_max_atributos': 0.373378161075968}. Best is trial 285 with value: 11.928484765389639.\n",
      "[I 2024-11-17 12:47:50,910] Trial 286 finished with value: 11.929063457887949 and parameters: {'num_arvores': 336, 'critério': 'poisson', 'min_exemplos_split': 33, 'min_exemplos_folha': 10, 'num_max_atributos': 0.43061923917846323}. Best is trial 285 with value: 11.928484765389639.\n",
      "[I 2024-11-17 12:47:59,095] Trial 287 finished with value: 11.933441369732263 and parameters: {'num_arvores': 326, 'critério': 'poisson', 'min_exemplos_split': 32, 'min_exemplos_folha': 10, 'num_max_atributos': 0.3628080195045297}. Best is trial 285 with value: 11.928484765389639.\n",
      "[I 2024-11-17 12:48:07,586] Trial 288 finished with value: 11.942239855214796 and parameters: {'num_arvores': 341, 'critério': 'poisson', 'min_exemplos_split': 34, 'min_exemplos_folha': 11, 'num_max_atributos': 0.41114784358282824}. Best is trial 285 with value: 11.928484765389639.\n",
      "[I 2024-11-17 12:48:15,251] Trial 289 finished with value: 11.93934637820864 and parameters: {'num_arvores': 290, 'critério': 'poisson', 'min_exemplos_split': 33, 'min_exemplos_folha': 13, 'num_max_atributos': 0.34190868130201096}. Best is trial 285 with value: 11.928484765389639.\n",
      "[I 2024-11-17 12:48:26,644] Trial 290 finished with value: 11.938235995622792 and parameters: {'num_arvores': 438, 'critério': 'poisson', 'min_exemplos_split': 35, 'min_exemplos_folha': 12, 'num_max_atributos': 0.4309942195840033}. Best is trial 285 with value: 11.928484765389639.\n",
      "[I 2024-11-17 12:48:35,850] Trial 291 finished with value: 11.938061631504702 and parameters: {'num_arvores': 365, 'critério': 'poisson', 'min_exemplos_split': 47, 'min_exemplos_folha': 10, 'num_max_atributos': 0.45627895882884056}. Best is trial 285 with value: 11.928484765389639.\n",
      "[I 2024-11-17 12:48:47,081] Trial 292 finished with value: 11.934103084532643 and parameters: {'num_arvores': 479, 'critério': 'poisson', 'min_exemplos_split': 41, 'min_exemplos_folha': 9, 'num_max_atributos': 0.39520995950684396}. Best is trial 285 with value: 11.928484765389639.\n",
      "[I 2024-11-17 12:48:54,564] Trial 293 finished with value: 11.941835503077334 and parameters: {'num_arvores': 307, 'critério': 'poisson', 'min_exemplos_split': 37, 'min_exemplos_folha': 7, 'num_max_atributos': 0.3710060393794045}. Best is trial 285 with value: 11.928484765389639.\n",
      "[I 2024-11-17 12:49:03,186] Trial 294 finished with value: 11.940635474167443 and parameters: {'num_arvores': 351, 'critério': 'poisson', 'min_exemplos_split': 44, 'min_exemplos_folha': 11, 'num_max_atributos': 0.4186639758264896}. Best is trial 285 with value: 11.928484765389639.\n",
      "[I 2024-11-17 12:49:15,142] Trial 295 finished with value: 11.931939283022535 and parameters: {'num_arvores': 452, 'critério': 'poisson', 'min_exemplos_split': 40, 'min_exemplos_folha': 8, 'num_max_atributos': 0.4920607491488995}. Best is trial 285 with value: 11.928484765389639.\n",
      "[I 2024-11-17 12:49:23,614] Trial 296 finished with value: 11.972337634790811 and parameters: {'num_arvores': 318, 'critério': 'poisson', 'min_exemplos_split': 40, 'min_exemplos_folha': 8, 'num_max_atributos': 0.5056918435336779}. Best is trial 285 with value: 11.928484765389639.\n",
      "[I 2024-11-17 12:49:30,604] Trial 297 finished with value: 11.958294714657633 and parameters: {'num_arvores': 253, 'critério': 'poisson', 'min_exemplos_split': 49, 'min_exemplos_folha': 10, 'num_max_atributos': 0.521734279917786}. Best is trial 285 with value: 11.928484765389639.\n",
      "[I 2024-11-17 12:49:42,053] Trial 298 finished with value: 11.94555765255514 and parameters: {'num_arvores': 448, 'critério': 'poisson', 'min_exemplos_split': 43, 'min_exemplos_folha': 13, 'num_max_atributos': 0.4906378534833031}. Best is trial 285 with value: 11.928484765389639.\n",
      "[I 2024-11-17 12:49:48,173] Trial 299 finished with value: 11.943177567143799 and parameters: {'num_arvores': 235, 'critério': 'poisson', 'min_exemplos_split': 39, 'min_exemplos_folha': 8, 'num_max_atributos': 0.45714111677047153}. Best is trial 285 with value: 11.928484765389639.\n",
      "[I 2024-11-17 12:49:55,841] Trial 300 finished with value: 11.937831446830957 and parameters: {'num_arvores': 291, 'critério': 'poisson', 'min_exemplos_split': 44, 'min_exemplos_folha': 7, 'num_max_atributos': 0.4342426202143939}. Best is trial 285 with value: 11.928484765389639.\n",
      "[I 2024-11-17 12:50:07,682] Trial 301 finished with value: 11.935980208330832 and parameters: {'num_arvores': 454, 'critério': 'poisson', 'min_exemplos_split': 41, 'min_exemplos_folha': 12, 'num_max_atributos': 0.4505200031229173}. Best is trial 285 with value: 11.928484765389639.\n",
      "[I 2024-11-17 12:50:18,757] Trial 302 finished with value: 11.941147441620977 and parameters: {'num_arvores': 432, 'critério': 'squared_error', 'min_exemplos_split': 35, 'min_exemplos_folha': 10, 'num_max_atributos': 0.4771513483388699}. Best is trial 285 with value: 11.928484765389639.\n",
      "[I 2024-11-17 12:50:30,066] Trial 303 finished with value: 11.935444021608765 and parameters: {'num_arvores': 479, 'critério': 'poisson', 'min_exemplos_split': 46, 'min_exemplos_folha': 8, 'num_max_atributos': 0.394145999500348}. Best is trial 285 with value: 11.928484765389639.\n",
      "[I 2024-11-17 12:50:42,104] Trial 304 finished with value: 11.934910545161594 and parameters: {'num_arvores': 453, 'critério': 'poisson', 'min_exemplos_split': 38, 'min_exemplos_folha': 9, 'num_max_atributos': 0.4830802812606958}. Best is trial 285 with value: 11.928484765389639.\n",
      "[I 2024-11-17 12:50:51,636] Trial 305 finished with value: 11.93430820482733 and parameters: {'num_arvores': 374, 'critério': 'poisson', 'min_exemplos_split': 33, 'min_exemplos_folha': 9, 'num_max_atributos': 0.42701880328135045}. Best is trial 285 with value: 11.928484765389639.\n",
      "[I 2024-11-17 12:51:02,619] Trial 306 finished with value: 11.935052501421001 and parameters: {'num_arvores': 470, 'critério': 'poisson', 'min_exemplos_split': 42, 'min_exemplos_folha': 11, 'num_max_atributos': 0.37979038379399915}. Best is trial 285 with value: 11.928484765389639.\n",
      "[I 2024-11-17 12:51:09,547] Trial 307 finished with value: 11.937873218400263 and parameters: {'num_arvores': 271, 'critério': 'friedman_mse', 'min_exemplos_split': 40, 'min_exemplos_folha': 7, 'num_max_atributos': 0.4130379841467067}. Best is trial 285 with value: 11.928484765389639.\n",
      "[I 2024-11-17 12:51:17,716] Trial 308 finished with value: 11.931350325675938 and parameters: {'num_arvores': 332, 'critério': 'poisson', 'min_exemplos_split': 36, 'min_exemplos_folha': 8, 'num_max_atributos': 0.4518349272160858}. Best is trial 285 with value: 11.928484765389639.\n",
      "[I 2024-11-17 12:51:25,883] Trial 309 finished with value: 11.945193020507391 and parameters: {'num_arvores': 322, 'critério': 'poisson', 'min_exemplos_split': 31, 'min_exemplos_folha': 6, 'num_max_atributos': 0.4565115172821246}. Best is trial 285 with value: 11.928484765389639.\n",
      "[I 2024-11-17 12:51:33,849] Trial 310 finished with value: 11.937765941148417 and parameters: {'num_arvores': 331, 'critério': 'poisson', 'min_exemplos_split': 36, 'min_exemplos_folha': 12, 'num_max_atributos': 0.4970315680952754}. Best is trial 285 with value: 11.928484765389639.\n",
      "[I 2024-11-17 12:51:42,663] Trial 311 finished with value: 11.940479161115968 and parameters: {'num_arvores': 357, 'critério': 'poisson', 'min_exemplos_split': 50, 'min_exemplos_folha': 10, 'num_max_atributos': 0.4710519288853964}. Best is trial 285 with value: 11.928484765389639.\n",
      "[I 2024-11-17 12:51:51,013] Trial 312 finished with value: 11.939739696947955 and parameters: {'num_arvores': 338, 'critério': 'poisson', 'min_exemplos_split': 34, 'min_exemplos_folha': 9, 'num_max_atributos': 0.43240900938679205}. Best is trial 285 with value: 11.928484765389639.\n",
      "[I 2024-11-17 12:51:58,949] Trial 313 finished with value: 11.949234996363977 and parameters: {'num_arvores': 309, 'critério': 'poisson', 'min_exemplos_split': 37, 'min_exemplos_folha': 4, 'num_max_atributos': 0.44815980634240166}. Best is trial 285 with value: 11.928484765389639.\n",
      "[I 2024-11-17 12:52:10,385] Trial 314 finished with value: 11.941594536298453 and parameters: {'num_arvores': 438, 'critério': 'poisson', 'min_exemplos_split': 46, 'min_exemplos_folha': 10, 'num_max_atributos': 0.36869895518631707}. Best is trial 285 with value: 11.928484765389639.\n",
      "[I 2024-11-17 12:52:18,319] Trial 315 finished with value: 11.942398590532786 and parameters: {'num_arvores': 329, 'critério': 'poisson', 'min_exemplos_split': 38, 'min_exemplos_folha': 11, 'num_max_atributos': 0.3374415349260162}. Best is trial 285 with value: 11.928484765389639.\n",
      "[I 2024-11-17 12:52:29,645] Trial 316 finished with value: 11.943569876448722 and parameters: {'num_arvores': 462, 'critério': 'poisson', 'min_exemplos_split': 32, 'min_exemplos_folha': 8, 'num_max_atributos': 0.4567189426045093}. Best is trial 285 with value: 11.928484765389639.\n",
      "[I 2024-11-17 12:52:38,401] Trial 317 finished with value: 11.943142365321346 and parameters: {'num_arvores': 344, 'critério': 'poisson', 'min_exemplos_split': 42, 'min_exemplos_folha': 1, 'num_max_atributos': 0.38903839234706655}. Best is trial 285 with value: 11.928484765389639.\n",
      "[I 2024-11-17 12:52:49,848] Trial 318 finished with value: 11.952738818308696 and parameters: {'num_arvores': 446, 'critério': 'poisson', 'min_exemplos_split': 36, 'min_exemplos_folha': 71, 'num_max_atributos': 0.5115245231762624}. Best is trial 285 with value: 11.928484765389639.\n",
      "[I 2024-11-17 12:53:01,100] Trial 319 finished with value: 11.936496133375515 and parameters: {'num_arvores': 482, 'critério': 'poisson', 'min_exemplos_split': 45, 'min_exemplos_folha': 7, 'num_max_atributos': 0.4298670526804096}. Best is trial 285 with value: 11.928484765389639.\n",
      "[I 2024-11-17 12:53:11,926] Trial 320 finished with value: 11.937309105216395 and parameters: {'num_arvores': 460, 'critério': 'poisson', 'min_exemplos_split': 39, 'min_exemplos_folha': 9, 'num_max_atributos': 0.4838796997808124}. Best is trial 285 with value: 11.928484765389639.\n",
      "[I 2024-11-17 12:53:24,161] Trial 321 finished with value: 11.959933724683504 and parameters: {'num_arvores': 470, 'critério': 'poisson', 'min_exemplos_split': 35, 'min_exemplos_folha': 13, 'num_max_atributos': 0.5334212602217148}. Best is trial 285 with value: 11.928484765389639.\n",
      "[I 2024-11-17 12:53:36,190] Trial 322 finished with value: 11.937576905705743 and parameters: {'num_arvores': 454, 'critério': 'poisson', 'min_exemplos_split': 42, 'min_exemplos_folha': 6, 'num_max_atributos': 0.35315000408519787}. Best is trial 285 with value: 11.928484765389639.\n",
      "[I 2024-11-17 12:53:47,662] Trial 323 finished with value: 11.939039873819954 and parameters: {'num_arvores': 483, 'critério': 'poisson', 'min_exemplos_split': 33, 'min_exemplos_folha': 9, 'num_max_atributos': 0.4119399653105491}. Best is trial 285 with value: 11.928484765389639.\n",
      "[I 2024-11-17 12:53:58,348] Trial 324 finished with value: 11.944468916815987 and parameters: {'num_arvores': 472, 'critério': 'squared_error', 'min_exemplos_split': 38, 'min_exemplos_folha': 12, 'num_max_atributos': 0.44345361453283627}. Best is trial 285 with value: 11.928484765389639.\n",
      "[I 2024-11-17 12:54:08,104] Trial 325 finished with value: 11.935060192338954 and parameters: {'num_arvores': 387, 'critério': 'poisson', 'min_exemplos_split': 47, 'min_exemplos_folha': 11, 'num_max_atributos': 0.3925415744033826}. Best is trial 285 with value: 11.928484765389639.\n",
      "[I 2024-11-17 12:54:15,482] Trial 326 finished with value: 11.92950526015482 and parameters: {'num_arvores': 283, 'critério': 'poisson', 'min_exemplos_split': 40, 'min_exemplos_folha': 8, 'num_max_atributos': 0.467843583649067}. Best is trial 285 with value: 11.928484765389639.\n",
      "[I 2024-11-17 12:54:23,183] Trial 327 finished with value: 11.937661484461607 and parameters: {'num_arvores': 286, 'critério': 'poisson', 'min_exemplos_split': 35, 'min_exemplos_folha': 10, 'num_max_atributos': 0.4652129688376956}. Best is trial 285 with value: 11.928484765389639.\n",
      "[I 2024-11-17 12:54:30,505] Trial 328 finished with value: 11.940062930423249 and parameters: {'num_arvores': 303, 'critério': 'poisson', 'min_exemplos_split': 44, 'min_exemplos_folha': 8, 'num_max_atributos': 0.4981875669290302}. Best is trial 285 with value: 11.928484765389639.\n",
      "[I 2024-11-17 12:54:37,889] Trial 329 finished with value: 11.943521358097446 and parameters: {'num_arvores': 282, 'critério': 'friedman_mse', 'min_exemplos_split': 39, 'min_exemplos_folha': 9, 'num_max_atributos': 0.4800699090222404}. Best is trial 285 with value: 11.928484765389639.\n",
      "[I 2024-11-17 12:54:44,811] Trial 330 finished with value: 11.945708095330975 and parameters: {'num_arvores': 262, 'critério': 'poisson', 'min_exemplos_split': 37, 'min_exemplos_folha': 7, 'num_max_atributos': 0.45294680171536816}. Best is trial 285 with value: 11.928484765389639.\n",
      "[I 2024-11-17 12:54:51,868] Trial 331 finished with value: 11.939694904258236 and parameters: {'num_arvores': 267, 'critério': 'poisson', 'min_exemplos_split': 31, 'min_exemplos_folha': 11, 'num_max_atributos': 0.4320984472196083}. Best is trial 285 with value: 11.928484765389639.\n",
      "[I 2024-11-17 12:54:59,833] Trial 332 finished with value: 11.938285922451588 and parameters: {'num_arvores': 298, 'critério': 'poisson', 'min_exemplos_split': 43, 'min_exemplos_folha': 10, 'num_max_atributos': 0.4763155466479801}. Best is trial 285 with value: 11.928484765389639.\n",
      "[I 2024-11-17 12:55:11,542] Trial 333 finished with value: 11.937582394186448 and parameters: {'num_arvores': 442, 'critério': 'poisson', 'min_exemplos_split': 40, 'min_exemplos_folha': 9, 'num_max_atributos': 0.3735063780767789}. Best is trial 285 with value: 11.928484765389639.\n",
      "[I 2024-11-17 12:55:19,345] Trial 334 finished with value: 11.94260291488532 and parameters: {'num_arvores': 316, 'critério': 'poisson', 'min_exemplos_split': 33, 'min_exemplos_folha': 13, 'num_max_atributos': 0.421292038727527}. Best is trial 285 with value: 11.928484765389639.\n",
      "[I 2024-11-17 12:55:26,738] Trial 335 finished with value: 11.935553433407954 and parameters: {'num_arvores': 278, 'critério': 'poisson', 'min_exemplos_split': 50, 'min_exemplos_folha': 8, 'num_max_atributos': 0.45603051744171264}. Best is trial 285 with value: 11.928484765389639.\n",
      "[I 2024-11-17 12:55:33,940] Trial 336 finished with value: 11.994454705430362 and parameters: {'num_arvores': 253, 'critério': 'poisson', 'min_exemplos_split': 35, 'min_exemplos_folha': 7, 'num_max_atributos': 0.5051566773475716}. Best is trial 285 with value: 11.928484765389639.\n",
      "[I 2024-11-17 12:55:45,721] Trial 337 finished with value: 11.933235825506047 and parameters: {'num_arvores': 452, 'critério': 'poisson', 'min_exemplos_split': 38, 'min_exemplos_folha': 10, 'num_max_atributos': 0.4382839861925656}. Best is trial 285 with value: 11.928484765389639.\n",
      "[I 2024-11-17 12:55:57,279] Trial 338 finished with value: 11.950379173948216 and parameters: {'num_arvores': 463, 'critério': 'poisson', 'min_exemplos_split': 2, 'min_exemplos_folha': 8, 'num_max_atributos': 0.4122146579305219}. Best is trial 285 with value: 11.928484765389639.\n",
      "[I 2024-11-17 12:56:03,962] Trial 339 finished with value: 11.972682675240145 and parameters: {'num_arvores': 243, 'critério': 'poisson', 'min_exemplos_split': 42, 'min_exemplos_folha': 10, 'num_max_atributos': 0.5557083582318627}. Best is trial 285 with value: 11.928484765389639.\n",
      "[I 2024-11-17 12:56:13,366] Trial 340 finished with value: 11.94274523948632 and parameters: {'num_arvores': 361, 'critério': 'poisson', 'min_exemplos_split': 46, 'min_exemplos_folha': 9, 'num_max_atributos': 0.35098733114301667}. Best is trial 285 with value: 11.928484765389639.\n",
      "[I 2024-11-17 12:56:24,785] Trial 341 finished with value: 11.93750277232396 and parameters: {'num_arvores': 426, 'critério': 'poisson', 'min_exemplos_split': 36, 'min_exemplos_folha': 11, 'num_max_atributos': 0.3888507056515152}. Best is trial 285 with value: 11.928484765389639.\n",
      "[I 2024-11-17 12:56:33,614] Trial 342 finished with value: 11.932739697444601 and parameters: {'num_arvores': 348, 'critério': 'poisson', 'min_exemplos_split': 40, 'min_exemplos_folha': 8, 'num_max_atributos': 0.47109289712664454}. Best is trial 285 with value: 11.928484765389639.\n",
      "[I 2024-11-17 12:56:42,108] Trial 343 finished with value: 11.94646164579533 and parameters: {'num_arvores': 323, 'critério': 'poisson', 'min_exemplos_split': 44, 'min_exemplos_folha': 6, 'num_max_atributos': 0.4949098817523846}. Best is trial 285 with value: 11.928484765389639.\n",
      "[I 2024-11-17 12:56:51,397] Trial 344 finished with value: 11.970482212457886 and parameters: {'num_arvores': 336, 'critério': 'poisson', 'min_exemplos_split': 39, 'min_exemplos_folha': 7, 'num_max_atributos': 0.524054808355159}. Best is trial 285 with value: 11.928484765389639.\n",
      "[I 2024-11-17 12:57:02,070] Trial 345 finished with value: 11.941705324434647 and parameters: {'num_arvores': 397, 'critério': 'poisson', 'min_exemplos_split': 34, 'min_exemplos_folha': 8, 'num_max_atributos': 0.47715004570201186}. Best is trial 285 with value: 11.928484765389639.\n",
      "[I 2024-11-17 12:57:10,893] Trial 346 finished with value: 11.942746507832158 and parameters: {'num_arvores': 346, 'critério': 'poisson', 'min_exemplos_split': 37, 'min_exemplos_folha': 7, 'num_max_atributos': 0.4626598231473508}. Best is trial 285 with value: 11.928484765389639.\n",
      "[I 2024-11-17 12:57:19,153] Trial 347 finished with value: 11.935602743850424 and parameters: {'num_arvores': 317, 'critério': 'poisson', 'min_exemplos_split': 42, 'min_exemplos_folha': 5, 'num_max_atributos': 0.4442477974683648}. Best is trial 285 with value: 11.928484765389639.\n",
      "[I 2024-11-17 12:57:27,742] Trial 348 finished with value: 11.936968674623904 and parameters: {'num_arvores': 333, 'critério': 'poisson', 'min_exemplos_split': 47, 'min_exemplos_folha': 9, 'num_max_atributos': 0.48919242629984894}. Best is trial 285 with value: 11.928484765389639.\n",
      "[I 2024-11-17 12:57:39,627] Trial 349 finished with value: 11.94339402325813 and parameters: {'num_arvores': 442, 'critério': 'squared_error', 'min_exemplos_split': 31, 'min_exemplos_folha': 8, 'num_max_atributos': 0.4655926194295036}. Best is trial 285 with value: 11.928484765389639.\n",
      "[I 2024-11-17 12:57:51,909] Trial 350 finished with value: 11.932344651519724 and parameters: {'num_arvores': 456, 'critério': 'poisson', 'min_exemplos_split': 40, 'min_exemplos_folha': 8, 'num_max_atributos': 0.4319646148565031}. Best is trial 285 with value: 11.928484765389639.\n",
      "[I 2024-11-17 12:58:03,093] Trial 351 finished with value: 11.933094516106001 and parameters: {'num_arvores': 414, 'critério': 'poisson', 'min_exemplos_split': 36, 'min_exemplos_folha': 9, 'num_max_atributos': 0.36762779812459906}. Best is trial 285 with value: 11.928484765389639.\n",
      "[I 2024-11-17 12:58:12,156] Trial 352 finished with value: 11.940674548027527 and parameters: {'num_arvores': 355, 'critério': 'friedman_mse', 'min_exemplos_split': 39, 'min_exemplos_folha': 11, 'num_max_atributos': 0.32407384916542853}. Best is trial 285 with value: 11.928484765389639.\n",
      "[I 2024-11-17 12:58:21,240] Trial 353 finished with value: 11.94229514270374 and parameters: {'num_arvores': 347, 'critério': 'poisson', 'min_exemplos_split': 33, 'min_exemplos_folha': 12, 'num_max_atributos': 0.42536059243674174}. Best is trial 285 with value: 11.928484765389639.\n",
      "[I 2024-11-17 12:58:33,879] Trial 354 finished with value: 11.940264310136445 and parameters: {'num_arvores': 456, 'critério': 'poisson', 'min_exemplos_split': 44, 'min_exemplos_folha': 8, 'num_max_atributos': 0.4177566282315998}. Best is trial 285 with value: 11.928484765389639.\n",
      "[I 2024-11-17 12:58:45,858] Trial 355 finished with value: 11.943933170400658 and parameters: {'num_arvores': 437, 'critério': 'poisson', 'min_exemplos_split': 37, 'min_exemplos_folha': 7, 'num_max_atributos': 0.4381608239374097}. Best is trial 285 with value: 11.928484765389639.\n",
      "[I 2024-11-17 12:58:58,227] Trial 356 finished with value: 11.938146548030375 and parameters: {'num_arvores': 452, 'critério': 'poisson', 'min_exemplos_split': 41, 'min_exemplos_folha': 13, 'num_max_atributos': 0.3865925413445551}. Best is trial 285 with value: 11.928484765389639.\n",
      "[I 2024-11-17 12:59:10,108] Trial 357 finished with value: 11.940197806101926 and parameters: {'num_arvores': 463, 'critério': 'poisson', 'min_exemplos_split': 34, 'min_exemplos_folha': 6, 'num_max_atributos': 0.46384235329091433}. Best is trial 285 with value: 11.928484765389639.\n",
      "[I 2024-11-17 12:59:22,851] Trial 358 finished with value: 11.935251014569399 and parameters: {'num_arvores': 448, 'critério': 'poisson', 'min_exemplos_split': 30, 'min_exemplos_folha': 9, 'num_max_atributos': 0.4030545745399957}. Best is trial 285 with value: 11.928484765389639.\n",
      "[I 2024-11-17 12:59:35,326] Trial 359 finished with value: 11.967103718078336 and parameters: {'num_arvores': 428, 'critério': 'poisson', 'min_exemplos_split': 39, 'min_exemplos_folha': 11, 'num_max_atributos': 0.508507474114922}. Best is trial 285 with value: 11.928484765389639.\n",
      "[I 2024-11-17 12:59:46,803] Trial 360 finished with value: 11.934841274730918 and parameters: {'num_arvores': 469, 'critério': 'poisson', 'min_exemplos_split': 48, 'min_exemplos_folha': 10, 'num_max_atributos': 0.3580166611422364}. Best is trial 285 with value: 11.928484765389639.\n",
      "[I 2024-11-17 12:59:59,465] Trial 361 finished with value: 11.943276944933649 and parameters: {'num_arvores': 456, 'critério': 'poisson', 'min_exemplos_split': 43, 'min_exemplos_folha': 9, 'num_max_atributos': 0.4829963852026478}. Best is trial 285 with value: 11.928484765389639.\n",
      "[I 2024-11-17 13:00:07,735] Trial 362 finished with value: 11.929167896387565 and parameters: {'num_arvores': 293, 'critério': 'poisson', 'min_exemplos_split': 36, 'min_exemplos_folha': 8, 'num_max_atributos': 0.43844883249071587}. Best is trial 285 with value: 11.928484765389639.\n",
      "[I 2024-11-17 13:00:16,238] Trial 363 finished with value: 11.93882277086934 and parameters: {'num_arvores': 295, 'critério': 'poisson', 'min_exemplos_split': 32, 'min_exemplos_folha': 7, 'num_max_atributos': 0.4248221506252926}. Best is trial 285 with value: 11.928484765389639.\n",
      "[I 2024-11-17 13:00:23,718] Trial 364 finished with value: 11.93817830218255 and parameters: {'num_arvores': 267, 'critério': 'poisson', 'min_exemplos_split': 35, 'min_exemplos_folha': 10, 'num_max_atributos': 0.3792488478354201}. Best is trial 285 with value: 11.928484765389639.\n",
      "[I 2024-11-17 13:00:31,374] Trial 365 finished with value: 11.936005438950419 and parameters: {'num_arvores': 276, 'critério': 'poisson', 'min_exemplos_split': 37, 'min_exemplos_folha': 12, 'num_max_atributos': 0.4520278399899022}. Best is trial 285 with value: 11.928484765389639.\n",
      "[I 2024-11-17 13:00:40,035] Trial 366 finished with value: 11.939067374588143 and parameters: {'num_arvores': 328, 'critério': 'poisson', 'min_exemplos_split': 34, 'min_exemplos_folha': 9, 'num_max_atributos': 0.39984109166145715}. Best is trial 285 with value: 11.928484765389639.\n",
      "[I 2024-11-17 13:00:48,058] Trial 367 finished with value: 11.936409315804033 and parameters: {'num_arvores': 287, 'critério': 'poisson', 'min_exemplos_split': 38, 'min_exemplos_folha': 8, 'num_max_atributos': 0.4233525194896909}. Best is trial 285 with value: 11.928484765389639.\n",
      "[I 2024-11-17 13:00:56,350] Trial 368 finished with value: 11.934814573603385 and parameters: {'num_arvores': 310, 'critério': 'poisson', 'min_exemplos_split': 35, 'min_exemplos_folha': 8, 'num_max_atributos': 0.33961865452342976}. Best is trial 285 with value: 11.928484765389639.\n",
      "[I 2024-11-17 13:01:03,457] Trial 369 finished with value: 11.937912223609796 and parameters: {'num_arvores': 260, 'critério': 'poisson', 'min_exemplos_split': 39, 'min_exemplos_folha': 11, 'num_max_atributos': 0.4719258512095946}. Best is trial 285 with value: 11.928484765389639.\n",
      "[I 2024-11-17 13:01:11,400] Trial 370 finished with value: 11.938712228535573 and parameters: {'num_arvores': 296, 'critério': 'squared_error', 'min_exemplos_split': 45, 'min_exemplos_folha': 10, 'num_max_atributos': 0.37336315202283066}. Best is trial 285 with value: 11.928484765389639.\n",
      "[I 2024-11-17 13:01:22,076] Trial 371 finished with value: 11.950742950071465 and parameters: {'num_arvores': 381, 'critério': 'poisson', 'min_exemplos_split': 30, 'min_exemplos_folha': 7, 'num_max_atributos': 0.4377977886623305}. Best is trial 285 with value: 11.928484765389639.\n",
      "[I 2024-11-17 13:01:30,155] Trial 372 finished with value: 11.93622321172661 and parameters: {'num_arvores': 282, 'critério': 'poisson', 'min_exemplos_split': 32, 'min_exemplos_folha': 9, 'num_max_atributos': 0.4088011105387101}. Best is trial 285 with value: 11.928484765389639.\n",
      "[I 2024-11-17 13:01:42,737] Trial 373 finished with value: 11.938123784184917 and parameters: {'num_arvores': 446, 'critério': 'poisson', 'min_exemplos_split': 36, 'min_exemplos_folha': 6, 'num_max_atributos': 0.4923562611395377}. Best is trial 285 with value: 11.928484765389639.\n",
      "[I 2024-11-17 13:01:51,972] Trial 374 finished with value: 11.94194081795892 and parameters: {'num_arvores': 334, 'critério': 'poisson', 'min_exemplos_split': 41, 'min_exemplos_folha': 2, 'num_max_atributos': 0.39235616317680283}. Best is trial 285 with value: 11.928484765389639.\n",
      "[I 2024-11-17 13:02:03,008] Trial 375 finished with value: 11.943195683800711 and parameters: {'num_arvores': 460, 'critério': 'friedman_mse', 'min_exemplos_split': 38, 'min_exemplos_folha': 13, 'num_max_atributos': 0.45599253301706255}. Best is trial 285 with value: 11.928484765389639.\n",
      "[I 2024-11-17 13:02:15,480] Trial 376 finished with value: 11.952969727932816 and parameters: {'num_arvores': 438, 'critério': 'poisson', 'min_exemplos_split': 50, 'min_exemplos_folha': 9, 'num_max_atributos': 0.5183081862238806}. Best is trial 285 with value: 11.928484765389639.\n",
      "[I 2024-11-17 13:02:23,307] Trial 377 finished with value: 11.941639597752921 and parameters: {'num_arvores': 300, 'critério': 'poisson', 'min_exemplos_split': 42, 'min_exemplos_folha': 12, 'num_max_atributos': 0.4303798701629959}. Best is trial 285 with value: 11.928484765389639.\n",
      "[I 2024-11-17 13:02:34,932] Trial 378 finished with value: 11.94628212894047 and parameters: {'num_arvores': 465, 'critério': 'poisson', 'min_exemplos_split': 34, 'min_exemplos_folha': 10, 'num_max_atributos': 0.36059925158391365}. Best is trial 285 with value: 11.928484765389639.\n",
      "[I 2024-11-17 13:02:42,641] Trial 379 finished with value: 11.933126137486866 and parameters: {'num_arvores': 275, 'critério': 'poisson', 'min_exemplos_split': 45, 'min_exemplos_folha': 8, 'num_max_atributos': 0.4086919977194447}. Best is trial 285 with value: 11.928484765389639.\n",
      "[I 2024-11-17 13:02:55,124] Trial 380 finished with value: 11.93244141859556 and parameters: {'num_arvores': 455, 'critério': 'poisson', 'min_exemplos_split': 40, 'min_exemplos_folha': 8, 'num_max_atributos': 0.46873576113988963}. Best is trial 285 with value: 11.928484765389639.\n",
      "[I 2024-11-17 13:03:03,165] Trial 381 finished with value: 11.942208553774947 and parameters: {'num_arvores': 313, 'critério': 'poisson', 'min_exemplos_split': 36, 'min_exemplos_folha': 14, 'num_max_atributos': 0.4766727999160123}. Best is trial 285 with value: 11.928484765389639.\n",
      "[I 2024-11-17 13:03:16,217] Trial 382 finished with value: 11.940367076258234 and parameters: {'num_arvores': 452, 'critério': 'poisson', 'min_exemplos_split': 3, 'min_exemplos_folha': 10, 'num_max_atributos': 0.49492794479016583}. Best is trial 285 with value: 11.928484765389639.\n",
      "[I 2024-11-17 13:03:28,578] Trial 383 finished with value: 11.933131299645433 and parameters: {'num_arvores': 441, 'critério': 'poisson', 'min_exemplos_split': 40, 'min_exemplos_folha': 7, 'num_max_atributos': 0.4618889865721377}. Best is trial 285 with value: 11.928484765389639.\n",
      "[I 2024-11-17 13:03:37,738] Trial 384 finished with value: 11.93969966412653 and parameters: {'num_arvores': 344, 'critério': 'poisson', 'min_exemplos_split': 37, 'min_exemplos_folha': 11, 'num_max_atributos': 0.37630028040297026}. Best is trial 285 with value: 11.928484765389639.\n",
      "[I 2024-11-17 13:03:50,543] Trial 385 finished with value: 11.941564269221843 and parameters: {'num_arvores': 450, 'critério': 'poisson', 'min_exemplos_split': 33, 'min_exemplos_folha': 8, 'num_max_atributos': 0.39261196484936295}. Best is trial 285 with value: 11.928484765389639.\n",
      "[I 2024-11-17 13:04:03,379] Trial 386 finished with value: 11.93750428644706 and parameters: {'num_arvores': 459, 'critério': 'poisson', 'min_exemplos_split': 39, 'min_exemplos_folha': 9, 'num_max_atributos': 0.4492264787837511}. Best is trial 285 with value: 11.928484765389639.\n",
      "[I 2024-11-17 13:04:15,594] Trial 387 finished with value: 11.945694771883542 and parameters: {'num_arvores': 432, 'critério': 'poisson', 'min_exemplos_split': 29, 'min_exemplos_folha': 10, 'num_max_atributos': 0.41990031788788573}. Best is trial 285 with value: 11.928484765389639.\n",
      "[I 2024-11-17 13:04:30,280] Trial 388 finished with value: 11.994402461985477 and parameters: {'num_arvores': 467, 'critério': 'poisson', 'min_exemplos_split': 43, 'min_exemplos_folha': 6, 'num_max_atributos': 0.8575300202936003}. Best is trial 285 with value: 11.928484765389639.\n",
      "[I 2024-11-17 13:04:43,677] Trial 389 finished with value: 11.96680647523752 and parameters: {'num_arvores': 457, 'critério': 'poisson', 'min_exemplos_split': 36, 'min_exemplos_folha': 12, 'num_max_atributos': 0.5495638080795575}. Best is trial 285 with value: 11.928484765389639.\n",
      "[I 2024-11-17 13:04:55,922] Trial 390 finished with value: 11.932696238654852 and parameters: {'num_arvores': 444, 'critério': 'poisson', 'min_exemplos_split': 40, 'min_exemplos_folha': 8, 'num_max_atributos': 0.3180396527660833}. Best is trial 285 with value: 11.928484765389639.\n",
      "[I 2024-11-17 13:05:08,156] Trial 391 finished with value: 11.940546854929869 and parameters: {'num_arvores': 443, 'critério': 'poisson', 'min_exemplos_split': 45, 'min_exemplos_folha': 9, 'num_max_atributos': 0.2911376959450987}. Best is trial 285 with value: 11.928484765389639.\n",
      "[I 2024-11-17 13:05:20,738] Trial 392 finished with value: 11.935628330893385 and parameters: {'num_arvores': 449, 'critério': 'poisson', 'min_exemplos_split': 38, 'min_exemplos_folha': 7, 'num_max_atributos': 0.3533406561365762}. Best is trial 285 with value: 11.928484765389639.\n",
      "[I 2024-11-17 13:05:32,621] Trial 393 finished with value: 11.937250033104762 and parameters: {'num_arvores': 426, 'critério': 'poisson', 'min_exemplos_split': 33, 'min_exemplos_folha': 11, 'num_max_atributos': 0.3788656296895262}. Best is trial 285 with value: 11.928484765389639.\n",
      "[I 2024-11-17 13:05:44,106] Trial 394 finished with value: 11.942685177937458 and parameters: {'num_arvores': 466, 'critério': 'poisson', 'min_exemplos_split': 42, 'min_exemplos_folha': 9, 'num_max_atributos': 0.33616406798745546}. Best is trial 285 with value: 11.928484765389639.\n",
      "[I 2024-11-17 13:05:56,389] Trial 395 finished with value: 11.932866554365123 and parameters: {'num_arvores': 456, 'critério': 'squared_error', 'min_exemplos_split': 48, 'min_exemplos_folha': 8, 'num_max_atributos': 0.3139321896696408}. Best is trial 285 with value: 11.928484765389639.\n",
      "[I 2024-11-17 13:06:08,436] Trial 396 finished with value: 11.938055001998123 and parameters: {'num_arvores': 442, 'critério': 'poisson', 'min_exemplos_split': 35, 'min_exemplos_folha': 10, 'num_max_atributos': 0.4041036471153918}. Best is trial 285 with value: 11.928484765389639.\n",
      "[I 2024-11-17 13:06:19,930] Trial 397 finished with value: 11.941992115020389 and parameters: {'num_arvores': 471, 'critério': 'friedman_mse', 'min_exemplos_split': 31, 'min_exemplos_folha': 12, 'num_max_atributos': 0.30385943084946665}. Best is trial 285 with value: 11.928484765389639.\n",
      "[I 2024-11-17 13:06:32,559] Trial 398 finished with value: 11.937504286447059 and parameters: {'num_arvores': 459, 'critério': 'poisson', 'min_exemplos_split': 39, 'min_exemplos_folha': 9, 'num_max_atributos': 0.32426124012070484}. Best is trial 285 with value: 11.928484765389639.\n",
      "[I 2024-11-17 13:06:44,953] Trial 399 finished with value: 11.944091649407653 and parameters: {'num_arvores': 437, 'critério': 'poisson', 'min_exemplos_split': 10, 'min_exemplos_folha': 11, 'num_max_atributos': 0.4294883882710355}. Best is trial 285 with value: 11.928484765389639.\n"
     ]
    }
   ],
   "source": [
    "NUM_TENTATIVAS = 200\n",
    "\n",
    "objeto_de_estudo.optimize(funcao_objetivo_parcial, n_trials=NUM_TENTATIVAS)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 22,
   "id": "f9f29e43-3e0b-4941-93c0-e924d6ac70aa",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Número do melhor trial: 285\n",
      "Parâmetros do melhor trial: {'num_arvores': 328, 'critério': 'poisson', 'min_exemplos_split': 33, 'min_exemplos_folha': 10, 'num_max_atributos': 0.373378161075968}\n"
     ]
    }
   ],
   "source": [
    "melhor_trial = objeto_de_estudo.best_trial\n",
    "\n",
    "print(f\"Número do melhor trial: {melhor_trial.number}\")\n",
    "print(f\"Parâmetros do melhor trial: {melhor_trial.params}\")"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "c0efbebf-551f-4498-981c-ba938db57029",
   "metadata": {},
   "source": [
    "### Estimando a performance do modelo floresta aleatória"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "1e845fc6-a9e3-4240-b3b9-ff0685017c8d",
   "metadata": {},
   "source": [
    "<p style=\"text-align:justify;\"> Nessa etapa, com os atributos que evitam multicolinearidade selecionados e os melhores hiperparâmentros encontrados pelo optuna, é momento de gerar o melhor modelo encontrado por esse conjunto de algorítmos. Para obter um bom estimador de performance do modelo, irá usar validação cruzada $k$​-fold.\n",
    "\n",
    "#### O RMSE obtido com os dados de teste separados anteriormente"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 23,
   "id": "abea73a5-114d-4254-a5fe-40b11bb33f2c",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "13.17116204335017\n"
     ]
    }
   ],
   "source": [
    "from sklearn.metrics import mean_squared_error\n",
    "\n",
    "modelo = cria_instancia_modelo(melhor_trial)\n",
    "modelo.fit(X_treino, y_treino)\n",
    "\n",
    "y_verdadeiro = y_teste\n",
    "y_previsao = modelo.predict(X_teste)\n",
    "\n",
    "RMSE = mean_squared_error(y_verdadeiro, y_previsao) ** (1/2)\n",
    "\n",
    "print(RMSE)"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "115fbb51-7fc2-42df-822c-c4d4d533994d",
   "metadata": {},
   "source": [
    "#### Dados do documento de hiperparametros1"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 24,
   "id": "d9dfc73a-dcf7-4d8f-8ab3-3bb890db234d",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>number</th>\n",
       "      <th>value</th>\n",
       "      <th>datetime_start</th>\n",
       "      <th>datetime_complete</th>\n",
       "      <th>duration</th>\n",
       "      <th>params_critério</th>\n",
       "      <th>params_min_exemplos_folha</th>\n",
       "      <th>params_min_exemplos_split</th>\n",
       "      <th>params_num_arvores</th>\n",
       "      <th>params_num_max_atributos</th>\n",
       "      <th>state</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>0</td>\n",
       "      <td>11.954616</td>\n",
       "      <td>2024-11-17 11:29:15.052460</td>\n",
       "      <td>2024-11-17 11:29:20.809677</td>\n",
       "      <td>0 days 00:00:05.757217</td>\n",
       "      <td>poisson</td>\n",
       "      <td>42</td>\n",
       "      <td>20</td>\n",
       "      <td>113</td>\n",
       "      <td>0.875503</td>\n",
       "      <td>COMPLETE</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>1</td>\n",
       "      <td>12.072660</td>\n",
       "      <td>2024-11-17 11:29:20.917366</td>\n",
       "      <td>2024-11-17 11:29:25.695680</td>\n",
       "      <td>0 days 00:00:04.778314</td>\n",
       "      <td>friedman_mse</td>\n",
       "      <td>3</td>\n",
       "      <td>28</td>\n",
       "      <td>130</td>\n",
       "      <td>0.836091</td>\n",
       "      <td>COMPLETE</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>2</td>\n",
       "      <td>12.082239</td>\n",
       "      <td>2024-11-17 11:29:25.890589</td>\n",
       "      <td>2024-11-17 11:29:33.686342</td>\n",
       "      <td>0 days 00:00:07.795753</td>\n",
       "      <td>friedman_mse</td>\n",
       "      <td>7</td>\n",
       "      <td>3</td>\n",
       "      <td>234</td>\n",
       "      <td>0.783942</td>\n",
       "      <td>COMPLETE</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>3</td>\n",
       "      <td>11.945102</td>\n",
       "      <td>2024-11-17 11:29:33.776826</td>\n",
       "      <td>2024-11-17 11:29:37.250439</td>\n",
       "      <td>0 days 00:00:03.473613</td>\n",
       "      <td>poisson</td>\n",
       "      <td>36</td>\n",
       "      <td>27</td>\n",
       "      <td>115</td>\n",
       "      <td>0.203767</td>\n",
       "      <td>COMPLETE</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>4</td>\n",
       "      <td>12.119539</td>\n",
       "      <td>2024-11-17 11:29:37.307582</td>\n",
       "      <td>2024-11-17 11:29:44.570218</td>\n",
       "      <td>0 days 00:00:07.262636</td>\n",
       "      <td>squared_error</td>\n",
       "      <td>2</td>\n",
       "      <td>15</td>\n",
       "      <td>206</td>\n",
       "      <td>0.571657</td>\n",
       "      <td>COMPLETE</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>395</th>\n",
       "      <td>395</td>\n",
       "      <td>11.932867</td>\n",
       "      <td>2024-11-17 13:05:44.118682</td>\n",
       "      <td>2024-11-17 13:05:56.357188</td>\n",
       "      <td>0 days 00:00:12.238506</td>\n",
       "      <td>squared_error</td>\n",
       "      <td>8</td>\n",
       "      <td>48</td>\n",
       "      <td>456</td>\n",
       "      <td>0.313932</td>\n",
       "      <td>COMPLETE</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>396</th>\n",
       "      <td>396</td>\n",
       "      <td>11.938055</td>\n",
       "      <td>2024-11-17 13:05:56.401863</td>\n",
       "      <td>2024-11-17 13:06:08.404325</td>\n",
       "      <td>0 days 00:00:12.002462</td>\n",
       "      <td>poisson</td>\n",
       "      <td>10</td>\n",
       "      <td>35</td>\n",
       "      <td>442</td>\n",
       "      <td>0.404104</td>\n",
       "      <td>COMPLETE</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>397</th>\n",
       "      <td>397</td>\n",
       "      <td>11.941992</td>\n",
       "      <td>2024-11-17 13:06:08.448547</td>\n",
       "      <td>2024-11-17 13:06:19.898064</td>\n",
       "      <td>0 days 00:00:11.449517</td>\n",
       "      <td>friedman_mse</td>\n",
       "      <td>12</td>\n",
       "      <td>31</td>\n",
       "      <td>471</td>\n",
       "      <td>0.303859</td>\n",
       "      <td>COMPLETE</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>398</th>\n",
       "      <td>398</td>\n",
       "      <td>11.937504</td>\n",
       "      <td>2024-11-17 13:06:19.944476</td>\n",
       "      <td>2024-11-17 13:06:32.439157</td>\n",
       "      <td>0 days 00:00:12.494681</td>\n",
       "      <td>poisson</td>\n",
       "      <td>9</td>\n",
       "      <td>39</td>\n",
       "      <td>459</td>\n",
       "      <td>0.324261</td>\n",
       "      <td>COMPLETE</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>399</th>\n",
       "      <td>399</td>\n",
       "      <td>11.944092</td>\n",
       "      <td>2024-11-17 13:06:32.571625</td>\n",
       "      <td>2024-11-17 13:06:44.921678</td>\n",
       "      <td>0 days 00:00:12.350053</td>\n",
       "      <td>poisson</td>\n",
       "      <td>11</td>\n",
       "      <td>10</td>\n",
       "      <td>437</td>\n",
       "      <td>0.429488</td>\n",
       "      <td>COMPLETE</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>400 rows × 11 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "     number      value             datetime_start          datetime_complete  \\\n",
       "0         0  11.954616 2024-11-17 11:29:15.052460 2024-11-17 11:29:20.809677   \n",
       "1         1  12.072660 2024-11-17 11:29:20.917366 2024-11-17 11:29:25.695680   \n",
       "2         2  12.082239 2024-11-17 11:29:25.890589 2024-11-17 11:29:33.686342   \n",
       "3         3  11.945102 2024-11-17 11:29:33.776826 2024-11-17 11:29:37.250439   \n",
       "4         4  12.119539 2024-11-17 11:29:37.307582 2024-11-17 11:29:44.570218   \n",
       "..      ...        ...                        ...                        ...   \n",
       "395     395  11.932867 2024-11-17 13:05:44.118682 2024-11-17 13:05:56.357188   \n",
       "396     396  11.938055 2024-11-17 13:05:56.401863 2024-11-17 13:06:08.404325   \n",
       "397     397  11.941992 2024-11-17 13:06:08.448547 2024-11-17 13:06:19.898064   \n",
       "398     398  11.937504 2024-11-17 13:06:19.944476 2024-11-17 13:06:32.439157   \n",
       "399     399  11.944092 2024-11-17 13:06:32.571625 2024-11-17 13:06:44.921678   \n",
       "\n",
       "                  duration params_critério  params_min_exemplos_folha  \\\n",
       "0   0 days 00:00:05.757217         poisson                         42   \n",
       "1   0 days 00:00:04.778314    friedman_mse                          3   \n",
       "2   0 days 00:00:07.795753    friedman_mse                          7   \n",
       "3   0 days 00:00:03.473613         poisson                         36   \n",
       "4   0 days 00:00:07.262636   squared_error                          2   \n",
       "..                     ...             ...                        ...   \n",
       "395 0 days 00:00:12.238506   squared_error                          8   \n",
       "396 0 days 00:00:12.002462         poisson                         10   \n",
       "397 0 days 00:00:11.449517    friedman_mse                         12   \n",
       "398 0 days 00:00:12.494681         poisson                          9   \n",
       "399 0 days 00:00:12.350053         poisson                         11   \n",
       "\n",
       "     params_min_exemplos_split  params_num_arvores  params_num_max_atributos  \\\n",
       "0                           20                 113                  0.875503   \n",
       "1                           28                 130                  0.836091   \n",
       "2                            3                 234                  0.783942   \n",
       "3                           27                 115                  0.203767   \n",
       "4                           15                 206                  0.571657   \n",
       "..                         ...                 ...                       ...   \n",
       "395                         48                 456                  0.313932   \n",
       "396                         35                 442                  0.404104   \n",
       "397                         31                 471                  0.303859   \n",
       "398                         39                 459                  0.324261   \n",
       "399                         10                 437                  0.429488   \n",
       "\n",
       "        state  \n",
       "0    COMPLETE  \n",
       "1    COMPLETE  \n",
       "2    COMPLETE  \n",
       "3    COMPLETE  \n",
       "4    COMPLETE  \n",
       "..        ...  \n",
       "395  COMPLETE  \n",
       "396  COMPLETE  \n",
       "397  COMPLETE  \n",
       "398  COMPLETE  \n",
       "399  COMPLETE  \n",
       "\n",
       "[400 rows x 11 columns]"
      ]
     },
     "execution_count": 24,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "from optuna import load_study\n",
    "\n",
    "objeto_de_estudo_carregado = load_study(\n",
    "    study_name=NOME_DO_ESTUDO,\n",
    "    storage=f\"sqlite:///{NOME_DO_ESTUDO}.db\",\n",
    ")\n",
    "\n",
    "df = objeto_de_estudo_carregado.trials_dataframe()\n",
    "\n",
    "df"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "a0f20ece-ccfa-4044-ac2f-c7acae019508",
   "metadata": {},
   "source": [
    "#### Avaliando a performance do modelo com a validação cruzada $k$​-fold."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 25,
   "id": "2ee6424a-95c2-4478-97d1-77acf64d4cbd",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "As métricas foram: [-12.89670078 -16.11619416 -11.10957974 -13.4543099  -13.57519612\n",
      " -16.8380261  -13.45529651 -14.61190863 -15.118844   -15.4672777\n",
      " -14.52041468 -17.19607671 -15.10624121 -14.2847592  -14.1621149\n",
      " -13.42099601 -15.75971273 -11.84707493 -14.59375272 -12.94824966\n",
      " -10.50731465 -13.61104373 -10.78060708 -11.84142377  -9.85744793\n",
      "  -9.40918286 -10.20486056 -10.11845952  -7.99859533  -8.4221797\n",
      "  -7.93004077  -8.50755913  -7.04860838  -6.87907781  -9.30820236\n",
      "  -9.54050682  -8.97646465  -8.03974466  -9.78089998  -8.16444229]\n",
      "\n",
      "A média das métricas é de: 11.835234709487974\n"
     ]
    }
   ],
   "source": [
    "from sklearn.model_selection import cross_val_score\n",
    "\n",
    "NUM_FOLDS = 40\n",
    "SEMENTE_ALEATORIA = 20404\n",
    "modelo_ad = cria_instancia_modelo(melhor_trial)\n",
    "\n",
    "metricas = cross_val_score(\n",
    "    modelo_ad,    #instância\n",
    "    X,            #dados de atributos\n",
    "    y,            #dados de target\n",
    "    cv=NUM_FOLDS, #número de folds\n",
    "    scoring=\"neg_root_mean_squared_error\", #quanto maior, melhor pelo scikit\n",
    ")\n",
    "\n",
    "print(\"As métricas foram:\", metricas)\n",
    "print()\n",
    "print(\"A média das métricas é de:\", np.abs(metricas.mean()))"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "dbe8676d-d7d7-47c1-93b0-57631f0b68dc",
   "metadata": {},
   "source": [
    "## Otimizando hiperparâmetros com o optuna para o regressor KNN\n",
    "\n",
    "<p style=\"text-align:justify;\"> Nessa momento, irá realizar as mesmas operações passadas, contudo o estudo será dedicado para o modelo KNN e com todos os atributos selecionados sem o VIF. Se esse apresentar um RMSE menor que o regressor de floresta aleatória, será esse o modelo escolhido para realizar a predição de sobrevida de um paciente predito como não curado pelo <strong>modelo classificador</strong>.\n",
    "\n",
    "#### Partindo do mesmo dataset comentado inicialmente"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 26,
   "id": "20e10b06-6743-41e8-bca5-85e277ad4c0f",
   "metadata": {},
   "outputs": [],
   "source": [
    "df = pd.read_csv(\"msk_met_2021_clinical_data (1).tsv\", sep = \"\\t\")\n",
    "\n",
    "df['Curado'] = pd.NA\n",
    "df ['Sobrevivencia (Meses)'] = pd.NA\n",
    "\n",
    "for i, meses in enumerate(df['Overall Survival (Months)']):\n",
    "    \n",
    "    if meses >= 60:\n",
    "        df.loc [i, 'Curado'] = 1\n",
    "        \n",
    "    else:\n",
    "        if df.loc [i, 'Overall Survival Status'] == '1:DECEASED':\n",
    "            df.loc [i, 'Curado'] = 0\n",
    "            df.loc [i, 'Sobrevivencia (Meses)'] = meses\n",
    "\n",
    "df = df.reindex(ATRIBUTOS + TARGET, axis=1)\n",
    "df = df.dropna()\n",
    "df = df.convert_dtypes()"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "7f5b4621-f271-4b5b-a078-b27e3e63b767",
   "metadata": {},
   "source": [
    "#### Separando dados de treino e teste"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 27,
   "id": "91e5a746-ce4d-4d48-b57f-d81d31cf7cee",
   "metadata": {},
   "outputs": [],
   "source": [
    "from sklearn.model_selection import train_test_split\n",
    "\n",
    "TAMANHO_TESTE = 0.1\n",
    "SEMENTE_ALEATORIA = 61455\n",
    "\n",
    "indices = df.index\n",
    "indices_treino, indices_teste = train_test_split(\n",
    "    indices, test_size=TAMANHO_TESTE, random_state=SEMENTE_ALEATORIA\n",
    ")\n",
    "\n",
    "df_treino = df.loc[indices_treino]\n",
    "df_teste = df.loc[indices_teste]\n",
    "\n",
    "X_treino = df_treino.reindex(ATRIBUTOS, axis=1).values\n",
    "y_treino = df_treino.reindex(TARGET, axis=1).values.ravel()\n",
    "\n",
    "X_teste = df_teste.reindex(ATRIBUTOS, axis=1).values\n",
    "y_teste = df_teste.reindex(TARGET, axis=1).values.ravel()\n",
    "\n",
    "X = df.reindex(ATRIBUTOS, axis=1).values\n",
    "y = df.reindex(TARGET, axis=1).values.ravel()"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "b76e4cfe-470d-4fe6-a200-83041db98526",
   "metadata": {},
   "source": [
    "#### Normalizando os atributos de treino\n",
    "\n",
    "<p style=\"text-align:justify;\"> Normalizar os dados para serem treinados é uma característica do modelo KNN, então, nesse ponto, ele diferencia de como foi treinado o modelo anterior. Os dados tiveram uma normalização padrão."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 28,
   "id": "d9d373a3-4a54-405f-991f-8e9d4783035e",
   "metadata": {},
   "outputs": [],
   "source": [
    "from sklearn.preprocessing import StandardScaler\n",
    "normalizador = StandardScaler()\n",
    "normalizador.fit(X_treino)\n",
    "X_norm = normalizador.transform(X_treino)"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "525fec05-285b-4eb5-9a4b-a03eccf8c76c",
   "metadata": {},
   "source": [
    "#### Criando as função de instaciar o modelo"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 29,
   "id": "629ab4d9-f9c1-4f29-9370-042232d40287",
   "metadata": {},
   "outputs": [],
   "source": [
    "from sklearn.neighbors import KNeighborsRegressor\n",
    "from sklearn.model_selection import cross_val_score\n",
    "\n",
    "def cria_instancia_modelo(trial):\n",
    "    \"\"\"Cria uma instância do modelo.\n",
    "\n",
    "    Args:\n",
    "      trial: objeto tipo Trial do optuna.\n",
    "\n",
    "    Returns:\n",
    "      Uma instância do modelo desejado.\n",
    "\n",
    "    \"\"\"\n",
    "    parametros = {\n",
    "        \"n_neighbors\": trial.suggest_int(\"vizinhos\", 4, 20),\n",
    "        \"weights\": trial.suggest_categorical(\n",
    "            \"pesos\", [\"uniform\", \"distance\"]\n",
    "        ),\n",
    "        \"p\": trial.suggest_float(\n",
    "            \"parametro_potencia\", 2, 10, log=True\n",
    "        )\n",
    "    }\n",
    "\n",
    "    model = KNeighborsRegressor(**parametros)\n",
    "\n",
    "    return model"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "3fa96bce-1206-4c4a-9a7b-da23d30cbaef",
   "metadata": {},
   "source": [
    "#### Criando a função objetivo"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 30,
   "id": "b76f430d-93d3-4ddb-a372-b4b7869663bb",
   "metadata": {},
   "outputs": [],
   "source": [
    "from sklearn.model_selection import cross_val_score\n",
    "\n",
    "def funcao_objetivo(trial, X, y, num_folds):\n",
    "    \"\"\"Função objetivo do optuna\n",
    "\n",
    "    Referencia:\n",
    "      https://medium.com/@walter_sperat/ using-optuna-with-sklearn-the-right-way-part-1-6b4ad0ab2451\n",
    "\n",
    "    \"\"\"\n",
    "    modelo = cria_instancia_modelo(trial)\n",
    "\n",
    "    metricas = cross_val_score(\n",
    "        modelo,\n",
    "        X,\n",
    "        y,\n",
    "        scoring=\"neg_root_mean_squared_error\",\n",
    "        cv=num_folds,\n",
    "    )\n",
    "\n",
    "    return -metricas.mean()"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "cab395e2-bfb9-499b-bbfa-4f654f3c0fb6",
   "metadata": {},
   "source": [
    "#### Criando o documento que irá salvar o estudo acrecar dos melhores hiperparâmetros para o KNN"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 31,
   "id": "41749b71-06ed-4ef7-94ea-bf25e31f9d18",
   "metadata": {},
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[I 2024-11-17 13:06:54,326] Using an existing study with name 'KNN_comparativo' instead of creating a new one.\n"
     ]
    }
   ],
   "source": [
    "from optuna import create_study\n",
    "\n",
    "NOME_DO_ESTUDO = \"KNN_comparativo\"\n",
    "\n",
    "objeto_de_estudo = create_study(\n",
    "    direction=\"minimize\",\n",
    "    study_name=NOME_DO_ESTUDO,\n",
    "    storage=f\"sqlite:///{NOME_DO_ESTUDO}.db\",\n",
    "    load_if_exists=True,\n",
    ")"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "e6e37e2d-54c6-4f24-a385-a89b2f08f55c",
   "metadata": {},
   "source": [
    "#### Função objetivo parcial"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 32,
   "id": "864c375b-07c8-4414-8cd2-22dfcb1b9e59",
   "metadata": {},
   "outputs": [],
   "source": [
    "NUM_FOLDS = 50\n",
    "\n",
    "def funcao_objetivo_parcial(trial):\n",
    "    return funcao_objetivo(trial, X_treino, y_treino, NUM_FOLDS)"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "1ca2db1c-98a6-41a7-b131-44e89b850fb1",
   "metadata": {},
   "source": [
    "#### Otimizando com o optuna"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 33,
   "id": "4f368699-0c12-4343-94ac-3985a026e158",
   "metadata": {},
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[I 2024-11-17 13:06:55,282] Trial 2 finished with value: 12.422505083415682 and parameters: {'vizinhos': 8, 'pesos': 'uniform', 'parametro_potencia': 4.960044756560448}. Best is trial 2 with value: 12.422505083415682.\n",
      "[I 2024-11-17 13:06:56,355] Trial 3 finished with value: 12.026096023720728 and parameters: {'vizinhos': 20, 'pesos': 'uniform', 'parametro_potencia': 5.632165303280377}. Best is trial 3 with value: 12.026096023720728.\n",
      "[I 2024-11-17 13:06:57,415] Trial 4 finished with value: 12.074772417778588 and parameters: {'vizinhos': 18, 'pesos': 'distance', 'parametro_potencia': 2.3383668145198904}. Best is trial 3 with value: 12.026096023720728.\n",
      "[I 2024-11-17 13:06:58,450] Trial 5 finished with value: 12.074964737297321 and parameters: {'vizinhos': 18, 'pesos': 'distance', 'parametro_potencia': 2.4456191716861646}. Best is trial 3 with value: 12.026096023720728.\n",
      "[I 2024-11-17 13:06:59,226] Trial 6 finished with value: 13.118372646022175 and parameters: {'vizinhos': 4, 'pesos': 'uniform', 'parametro_potencia': 6.7521543641670085}. Best is trial 3 with value: 12.026096023720728.\n",
      "[I 2024-11-17 13:07:00,078] Trial 7 finished with value: 12.60861531734615 and parameters: {'vizinhos': 7, 'pesos': 'distance', 'parametro_potencia': 4.628417541529922}. Best is trial 3 with value: 12.026096023720728.\n",
      "[I 2024-11-17 13:07:01,097] Trial 8 finished with value: 12.114880885314637 and parameters: {'vizinhos': 15, 'pesos': 'uniform', 'parametro_potencia': 4.806427441606818}. Best is trial 3 with value: 12.026096023720728.\n",
      "[I 2024-11-17 13:07:02,062] Trial 9 finished with value: 12.117661999696251 and parameters: {'vizinhos': 16, 'pesos': 'distance', 'parametro_potencia': 3.173596238647713}. Best is trial 3 with value: 12.026096023720728.\n",
      "[I 2024-11-17 13:07:02,944] Trial 10 finished with value: 12.335321242877564 and parameters: {'vizinhos': 10, 'pesos': 'distance', 'parametro_potencia': 5.038177751489533}. Best is trial 3 with value: 12.026096023720728.\n",
      "[I 2024-11-17 13:07:03,925] Trial 11 finished with value: 12.060189378864013 and parameters: {'vizinhos': 18, 'pesos': 'uniform', 'parametro_potencia': 6.779257560314171}. Best is trial 3 with value: 12.026096023720728.\n",
      "[I 2024-11-17 13:07:04,885] Trial 12 finished with value: 12.173859109831579 and parameters: {'vizinhos': 13, 'pesos': 'uniform', 'parametro_potencia': 9.452609293931335}. Best is trial 3 with value: 12.026096023720728.\n",
      "[I 2024-11-17 13:07:05,857] Trial 13 finished with value: 12.029237970583598 and parameters: {'vizinhos': 20, 'pesos': 'uniform', 'parametro_potencia': 7.380957934837936}. Best is trial 3 with value: 12.026096023720728.\n",
      "[I 2024-11-17 13:07:06,829] Trial 14 finished with value: 12.029162347963473 and parameters: {'vizinhos': 20, 'pesos': 'uniform', 'parametro_potencia': 7.583629832502427}. Best is trial 3 with value: 12.026096023720728.\n",
      "[I 2024-11-17 13:07:07,822] Trial 15 finished with value: 12.031162064694911 and parameters: {'vizinhos': 20, 'pesos': 'uniform', 'parametro_potencia': 9.981789989551459}. Best is trial 3 with value: 12.026096023720728.\n",
      "[I 2024-11-17 13:07:08,778] Trial 16 finished with value: 12.130434621284605 and parameters: {'vizinhos': 14, 'pesos': 'uniform', 'parametro_potencia': 3.510269329803857}. Best is trial 3 with value: 12.026096023720728.\n",
      "[I 2024-11-17 13:07:09,828] Trial 17 finished with value: 12.068261288088936 and parameters: {'vizinhos': 17, 'pesos': 'uniform', 'parametro_potencia': 6.056051234027514}. Best is trial 3 with value: 12.026096023720728.\n",
      "[I 2024-11-17 13:07:10,708] Trial 18 finished with value: 12.248081018593746 and parameters: {'vizinhos': 11, 'pesos': 'uniform', 'parametro_potencia': 8.255128936524484}. Best is trial 3 with value: 12.026096023720728.\n",
      "[I 2024-11-17 13:07:11,759] Trial 19 finished with value: 12.027227727225336 and parameters: {'vizinhos': 20, 'pesos': 'uniform', 'parametro_potencia': 3.6361704618556026}. Best is trial 3 with value: 12.026096023720728.\n",
      "[I 2024-11-17 13:07:12,756] Trial 20 finished with value: 12.084399280964218 and parameters: {'vizinhos': 16, 'pesos': 'uniform', 'parametro_potencia': 3.749047278025708}. Best is trial 3 with value: 12.026096023720728.\n",
      "[I 2024-11-17 13:07:13,696] Trial 21 finished with value: 12.156645069064412 and parameters: {'vizinhos': 13, 'pesos': 'uniform', 'parametro_potencia': 2.9061916630287685}. Best is trial 3 with value: 12.026096023720728.\n",
      "[I 2024-11-17 13:07:14,717] Trial 22 finished with value: 12.039983970007883 and parameters: {'vizinhos': 19, 'pesos': 'uniform', 'parametro_potencia': 4.0061581725384565}. Best is trial 3 with value: 12.026096023720728.\n",
      "[I 2024-11-17 13:07:15,694] Trial 23 finished with value: 12.026928288377603 and parameters: {'vizinhos': 20, 'pesos': 'uniform', 'parametro_potencia': 5.515302445591465}. Best is trial 3 with value: 12.026096023720728.\n",
      "[I 2024-11-17 13:07:16,679] Trial 24 finished with value: 12.027907542351693 and parameters: {'vizinhos': 20, 'pesos': 'uniform', 'parametro_potencia': 5.686601590531592}. Best is trial 3 with value: 12.026096023720728.\n",
      "[I 2024-11-17 13:07:17,692] Trial 25 finished with value: 12.069532220389547 and parameters: {'vizinhos': 17, 'pesos': 'uniform', 'parametro_potencia': 5.685512220986799}. Best is trial 3 with value: 12.026096023720728.\n",
      "[I 2024-11-17 13:07:18,754] Trial 26 finished with value: 12.041447717691149 and parameters: {'vizinhos': 19, 'pesos': 'uniform', 'parametro_potencia': 4.139946449608273}. Best is trial 3 with value: 12.026096023720728.\n",
      "[I 2024-11-17 13:07:19,942] Trial 27 finished with value: 12.085500837098829 and parameters: {'vizinhos': 16, 'pesos': 'uniform', 'parametro_potencia': 2.852086821026766}. Best is trial 3 with value: 12.026096023720728.\n",
      "[I 2024-11-17 13:07:20,918] Trial 28 finished with value: 12.078653027744434 and parameters: {'vizinhos': 18, 'pesos': 'distance', 'parametro_potencia': 4.318819115149066}. Best is trial 3 with value: 12.026096023720728.\n",
      "[I 2024-11-17 13:07:21,931] Trial 29 finished with value: 12.106414528447269 and parameters: {'vizinhos': 15, 'pesos': 'uniform', 'parametro_potencia': 3.399289959050585}. Best is trial 3 with value: 12.026096023720728.\n",
      "[I 2024-11-17 13:07:22,921] Trial 30 finished with value: 12.042600650055096 and parameters: {'vizinhos': 19, 'pesos': 'uniform', 'parametro_potencia': 5.4436396210722435}. Best is trial 3 with value: 12.026096023720728.\n",
      "[I 2024-11-17 13:07:23,872] Trial 31 finished with value: 12.421941159039845 and parameters: {'vizinhos': 8, 'pesos': 'uniform', 'parametro_potencia': 6.248913663215479}. Best is trial 3 with value: 12.026096023720728.\n",
      "[I 2024-11-17 13:07:25,026] Trial 32 finished with value: 12.07344316087872 and parameters: {'vizinhos': 17, 'pesos': 'uniform', 'parametro_potencia': 2.018132087130933}. Best is trial 3 with value: 12.026096023720728.\n",
      "[I 2024-11-17 13:07:26,001] Trial 33 finished with value: 12.021513311287599 and parameters: {'vizinhos': 20, 'pesos': 'uniform', 'parametro_potencia': 5.343868890171822}. Best is trial 33 with value: 12.021513311287599.\n",
      "[I 2024-11-17 13:07:26,971] Trial 34 finished with value: 12.047899745687532 and parameters: {'vizinhos': 19, 'pesos': 'uniform', 'parametro_potencia': 4.957382434523358}. Best is trial 33 with value: 12.021513311287599.\n",
      "[I 2024-11-17 13:07:28,105] Trial 35 finished with value: 12.021865346480476 and parameters: {'vizinhos': 20, 'pesos': 'uniform', 'parametro_potencia': 5.255408424815355}. Best is trial 33 with value: 12.021513311287599.\n",
      "[I 2024-11-17 13:07:29,164] Trial 36 finished with value: 12.065032933254152 and parameters: {'vizinhos': 19, 'pesos': 'distance', 'parametro_potencia': 5.129677815196462}. Best is trial 33 with value: 12.021513311287599.\n",
      "[I 2024-11-17 13:07:30,016] Trial 37 finished with value: 13.117416941397915 and parameters: {'vizinhos': 4, 'pesos': 'uniform', 'parametro_potencia': 6.144506351544797}. Best is trial 33 with value: 12.021513311287599.\n",
      "[I 2024-11-17 13:07:30,986] Trial 38 finished with value: 12.082825319301135 and parameters: {'vizinhos': 18, 'pesos': 'distance', 'parametro_potencia': 4.588793384046838}. Best is trial 33 with value: 12.021513311287599.\n",
      "[I 2024-11-17 13:07:32,008] Trial 39 finished with value: 12.065085841902636 and parameters: {'vizinhos': 17, 'pesos': 'uniform', 'parametro_potencia': 6.92029230034521}. Best is trial 33 with value: 12.021513311287599.\n",
      "[I 2024-11-17 13:07:32,844] Trial 40 finished with value: 12.564307869889962 and parameters: {'vizinhos': 7, 'pesos': 'uniform', 'parametro_potencia': 5.383782524278912}. Best is trial 33 with value: 12.021513311287599.\n",
      "[I 2024-11-17 13:07:33,867] Trial 41 finished with value: 12.082771282092224 and parameters: {'vizinhos': 18, 'pesos': 'distance', 'parametro_potencia': 4.582716784291182}. Best is trial 33 with value: 12.021513311287599.\n",
      "[I 2024-11-17 13:07:35,028] Trial 42 finished with value: 12.027952171822037 and parameters: {'vizinhos': 20, 'pesos': 'uniform', 'parametro_potencia': 7.944319221758495}. Best is trial 33 with value: 12.021513311287599.\n",
      "[I 2024-11-17 13:07:36,017] Trial 43 finished with value: 12.027820985321476 and parameters: {'vizinhos': 20, 'pesos': 'uniform', 'parametro_potencia': 3.8219282133633303}. Best is trial 33 with value: 12.021513311287599.\n",
      "[I 2024-11-17 13:07:37,064] Trial 44 finished with value: 12.045432777799235 and parameters: {'vizinhos': 19, 'pesos': 'uniform', 'parametro_potencia': 6.31882024986907}. Best is trial 33 with value: 12.021513311287599.\n",
      "[I 2024-11-17 13:07:38,113] Trial 45 finished with value: 12.060973781162637 and parameters: {'vizinhos': 18, 'pesos': 'uniform', 'parametro_potencia': 5.150690151236844}. Best is trial 33 with value: 12.021513311287599.\n",
      "[I 2024-11-17 13:07:39,178] Trial 46 finished with value: 12.02784416770928 and parameters: {'vizinhos': 20, 'pesos': 'uniform', 'parametro_potencia': 4.267900066723105}. Best is trial 33 with value: 12.021513311287599.\n",
      "[I 2024-11-17 13:07:40,178] Trial 47 finished with value: 12.047581996139058 and parameters: {'vizinhos': 19, 'pesos': 'uniform', 'parametro_potencia': 4.800705203301589}. Best is trial 33 with value: 12.021513311287599.\n",
      "[I 2024-11-17 13:07:41,152] Trial 48 finished with value: 12.026248156438035 and parameters: {'vizinhos': 20, 'pesos': 'uniform', 'parametro_potencia': 5.81415304141963}. Best is trial 33 with value: 12.021513311287599.\n",
      "[I 2024-11-17 13:07:42,194] Trial 49 finished with value: 12.078820081058211 and parameters: {'vizinhos': 18, 'pesos': 'distance', 'parametro_potencia': 6.964220012860972}. Best is trial 33 with value: 12.021513311287599.\n",
      "[I 2024-11-17 13:07:43,176] Trial 50 finished with value: 12.113461216150458 and parameters: {'vizinhos': 15, 'pesos': 'uniform', 'parametro_potencia': 5.831981178843331}. Best is trial 33 with value: 12.021513311287599.\n",
      "[I 2024-11-17 13:07:44,172] Trial 51 finished with value: 12.064770807738352 and parameters: {'vizinhos': 17, 'pesos': 'uniform', 'parametro_potencia': 6.551380961630473}. Best is trial 33 with value: 12.021513311287599.\n",
      "[I 2024-11-17 13:07:45,136] Trial 52 finished with value: 12.349867199515304 and parameters: {'vizinhos': 9, 'pesos': 'uniform', 'parametro_potencia': 8.764569687831688}. Best is trial 33 with value: 12.021513311287599.\n",
      "[I 2024-11-17 13:07:46,165] Trial 53 finished with value: 12.021976104450566 and parameters: {'vizinhos': 20, 'pesos': 'uniform', 'parametro_potencia': 5.27852535172109}. Best is trial 33 with value: 12.021513311287599.\n",
      "[I 2024-11-17 13:07:47,253] Trial 54 finished with value: 12.022858076689348 and parameters: {'vizinhos': 20, 'pesos': 'uniform', 'parametro_potencia': 5.38453832633127}. Best is trial 33 with value: 12.021513311287599.\n",
      "[I 2024-11-17 13:07:48,313] Trial 55 finished with value: 12.045927927383609 and parameters: {'vizinhos': 19, 'pesos': 'uniform', 'parametro_potencia': 5.34834547478129}. Best is trial 33 with value: 12.021513311287599.\n",
      "[I 2024-11-17 13:07:49,361] Trial 56 finished with value: 12.022178729374952 and parameters: {'vizinhos': 20, 'pesos': 'uniform', 'parametro_potencia': 5.951365924245805}. Best is trial 33 with value: 12.021513311287599.\n",
      "[I 2024-11-17 13:07:50,377] Trial 57 finished with value: 12.019677704294402 and parameters: {'vizinhos': 20, 'pesos': 'uniform', 'parametro_potencia': 4.7865544337983215}. Best is trial 57 with value: 12.019677704294402.\n",
      "[I 2024-11-17 13:07:51,348] Trial 58 finished with value: 12.046455327997768 and parameters: {'vizinhos': 19, 'pesos': 'uniform', 'parametro_potencia': 4.830928502357227}. Best is trial 57 with value: 12.019677704294402.\n",
      "[I 2024-11-17 13:07:52,274] Trial 59 finished with value: 12.867739035825652 and parameters: {'vizinhos': 5, 'pesos': 'uniform', 'parametro_potencia': 4.450074527703204}. Best is trial 57 with value: 12.019677704294402.\n",
      "[I 2024-11-17 13:07:53,358] Trial 60 finished with value: 12.028096437583333 and parameters: {'vizinhos': 20, 'pesos': 'uniform', 'parametro_potencia': 4.033455847836686}. Best is trial 57 with value: 12.019677704294402.\n",
      "[I 2024-11-17 13:07:54,355] Trial 61 finished with value: 12.095263636153897 and parameters: {'vizinhos': 16, 'pesos': 'uniform', 'parametro_potencia': 5.182423263430851}. Best is trial 57 with value: 12.019677704294402.\n",
      "[I 2024-11-17 13:07:55,384] Trial 62 finished with value: 12.059205731672607 and parameters: {'vizinhos': 18, 'pesos': 'uniform', 'parametro_potencia': 5.949374286596144}. Best is trial 57 with value: 12.019677704294402.\n",
      "[I 2024-11-17 13:07:56,361] Trial 63 finished with value: 12.028459101773258 and parameters: {'vizinhos': 20, 'pesos': 'uniform', 'parametro_potencia': 6.536303189684068}. Best is trial 57 with value: 12.019677704294402.\n",
      "[I 2024-11-17 13:07:57,277] Trial 64 finished with value: 12.247396680772987 and parameters: {'vizinhos': 11, 'pesos': 'uniform', 'parametro_potencia': 7.385312974596949}. Best is trial 57 with value: 12.019677704294402.\n",
      "[I 2024-11-17 13:07:58,306] Trial 65 finished with value: 12.02145289762908 and parameters: {'vizinhos': 20, 'pesos': 'uniform', 'parametro_potencia': 4.857737974791718}. Best is trial 57 with value: 12.019677704294402.\n",
      "[I 2024-11-17 13:07:59,325] Trial 66 finished with value: 12.01985666422752 and parameters: {'vizinhos': 20, 'pesos': 'uniform', 'parametro_potencia': 4.789950761837763}. Best is trial 57 with value: 12.019677704294402.\n",
      "[I 2024-11-17 13:08:00,334] Trial 67 finished with value: 12.048326102283827 and parameters: {'vizinhos': 19, 'pesos': 'uniform', 'parametro_potencia': 4.74278360430791}. Best is trial 57 with value: 12.019677704294402.\n",
      "[I 2024-11-17 13:08:01,348] Trial 68 finished with value: 12.0465560144944 and parameters: {'vizinhos': 19, 'pesos': 'uniform', 'parametro_potencia': 4.433258177208786}. Best is trial 57 with value: 12.019677704294402.\n",
      "[I 2024-11-17 13:08:02,365] Trial 69 finished with value: 12.06794721788643 and parameters: {'vizinhos': 19, 'pesos': 'distance', 'parametro_potencia': 4.945577241036726}. Best is trial 57 with value: 12.019677704294402.\n",
      "[I 2024-11-17 13:08:03,363] Trial 70 finished with value: 12.026796127531846 and parameters: {'vizinhos': 20, 'pesos': 'uniform', 'parametro_potencia': 5.5953663162518295}. Best is trial 57 with value: 12.019677704294402.\n",
      "[I 2024-11-17 13:08:04,380] Trial 71 finished with value: 12.060362793582447 and parameters: {'vizinhos': 18, 'pesos': 'uniform', 'parametro_potencia': 5.102262866799245}. Best is trial 57 with value: 12.019677704294402.\n",
      "[I 2024-11-17 13:08:05,368] Trial 72 finished with value: 12.02621937161463 and parameters: {'vizinhos': 20, 'pesos': 'uniform', 'parametro_potencia': 4.307887605773749}. Best is trial 57 with value: 12.019677704294402.\n",
      "[I 2024-11-17 13:08:06,376] Trial 73 finished with value: 12.024394468514034 and parameters: {'vizinhos': 20, 'pesos': 'uniform', 'parametro_potencia': 5.4045574806655825}. Best is trial 57 with value: 12.019677704294402.\n",
      "[I 2024-11-17 13:08:07,350] Trial 74 finished with value: 12.048232323648712 and parameters: {'vizinhos': 19, 'pesos': 'uniform', 'parametro_potencia': 4.673028963247459}. Best is trial 57 with value: 12.019677704294402.\n",
      "[I 2024-11-17 13:08:08,333] Trial 75 finished with value: 12.022013061232093 and parameters: {'vizinhos': 20, 'pesos': 'uniform', 'parametro_potencia': 5.24785876245377}. Best is trial 57 with value: 12.019677704294402.\n",
      "[I 2024-11-17 13:08:09,366] Trial 76 finished with value: 12.022243280073244 and parameters: {'vizinhos': 20, 'pesos': 'uniform', 'parametro_potencia': 4.949858808225305}. Best is trial 57 with value: 12.019677704294402.\n",
      "[I 2024-11-17 13:08:10,417] Trial 77 finished with value: 12.039497947674597 and parameters: {'vizinhos': 19, 'pesos': 'uniform', 'parametro_potencia': 5.6618086212984595}. Best is trial 57 with value: 12.019677704294402.\n",
      "[I 2024-11-17 13:08:11,426] Trial 78 finished with value: 12.169474049380915 and parameters: {'vizinhos': 13, 'pesos': 'uniform', 'parametro_potencia': 6.081629962653141}. Best is trial 57 with value: 12.019677704294402.\n",
      "[I 2024-11-17 13:08:12,403] Trial 79 finished with value: 12.054107701001918 and parameters: {'vizinhos': 18, 'pesos': 'uniform', 'parametro_potencia': 3.892502652330307}. Best is trial 57 with value: 12.019677704294402.\n",
      "[I 2024-11-17 13:08:13,370] Trial 80 finished with value: 12.0921831163812 and parameters: {'vizinhos': 17, 'pesos': 'distance', 'parametro_potencia': 5.1640297509012685}. Best is trial 57 with value: 12.019677704294402.\n",
      "[I 2024-11-17 13:08:14,411] Trial 81 finished with value: 12.027760275512835 and parameters: {'vizinhos': 20, 'pesos': 'uniform', 'parametro_potencia': 4.19308728274039}. Best is trial 57 with value: 12.019677704294402.\n",
      "[I 2024-11-17 13:08:15,387] Trial 82 finished with value: 12.046191938900522 and parameters: {'vizinhos': 19, 'pesos': 'uniform', 'parametro_potencia': 4.517184945002958}. Best is trial 57 with value: 12.019677704294402.\n",
      "[I 2024-11-17 13:08:16,419] Trial 83 finished with value: 12.021962694805067 and parameters: {'vizinhos': 20, 'pesos': 'uniform', 'parametro_potencia': 4.9215259457545635}. Best is trial 57 with value: 12.019677704294402.\n",
      "[I 2024-11-17 13:08:17,401] Trial 84 finished with value: 12.020054605954888 and parameters: {'vizinhos': 20, 'pesos': 'uniform', 'parametro_potencia': 4.781868384559534}. Best is trial 57 with value: 12.019677704294402.\n",
      "[I 2024-11-17 13:08:18,478] Trial 85 finished with value: 12.021074059451944 and parameters: {'vizinhos': 20, 'pesos': 'uniform', 'parametro_potencia': 4.669416980776075}. Best is trial 57 with value: 12.019677704294402.\n",
      "[I 2024-11-17 13:08:19,512] Trial 86 finished with value: 12.047465420797675 and parameters: {'vizinhos': 19, 'pesos': 'uniform', 'parametro_potencia': 4.722295942809045}. Best is trial 57 with value: 12.019677704294402.\n",
      "[I 2024-11-17 13:08:20,511] Trial 87 finished with value: 12.065101410504738 and parameters: {'vizinhos': 18, 'pesos': 'uniform', 'parametro_potencia': 4.952527948464203}. Best is trial 57 with value: 12.019677704294402.\n",
      "[I 2024-11-17 13:08:21,523] Trial 88 finished with value: 12.02641542541075 and parameters: {'vizinhos': 20, 'pesos': 'uniform', 'parametro_potencia': 4.046978250653547}. Best is trial 57 with value: 12.019677704294402.\n",
      "[I 2024-11-17 13:08:22,564] Trial 89 finished with value: 12.042050242742254 and parameters: {'vizinhos': 19, 'pesos': 'uniform', 'parametro_potencia': 3.687423884634624}. Best is trial 57 with value: 12.019677704294402.\n",
      "[I 2024-11-17 13:08:23,571] Trial 90 finished with value: 12.024048240445415 and parameters: {'vizinhos': 20, 'pesos': 'uniform', 'parametro_potencia': 4.520870370044167}. Best is trial 57 with value: 12.019677704294402.\n",
      "[I 2024-11-17 13:08:24,578] Trial 91 finished with value: 12.059664709510933 and parameters: {'vizinhos': 18, 'pesos': 'uniform', 'parametro_potencia': 4.389504831629582}. Best is trial 57 with value: 12.019677704294402.\n",
      "[I 2024-11-17 13:08:25,592] Trial 92 finished with value: 12.067094634090644 and parameters: {'vizinhos': 19, 'pesos': 'distance', 'parametro_potencia': 4.836611321082702}. Best is trial 57 with value: 12.019677704294402.\n",
      "[I 2024-11-17 13:08:26,648] Trial 93 finished with value: 12.022021607912013 and parameters: {'vizinhos': 20, 'pesos': 'uniform', 'parametro_potencia': 5.262684963995002}. Best is trial 57 with value: 12.019677704294402.\n",
      "[I 2024-11-17 13:08:27,625] Trial 94 finished with value: 12.026735938062224 and parameters: {'vizinhos': 20, 'pesos': 'uniform', 'parametro_potencia': 5.579290717399799}. Best is trial 57 with value: 12.019677704294402.\n",
      "[I 2024-11-17 13:08:28,607] Trial 95 finished with value: 12.022393771760417 and parameters: {'vizinhos': 20, 'pesos': 'uniform', 'parametro_potencia': 4.981899495190444}. Best is trial 57 with value: 12.019677704294402.\n",
      "[I 2024-11-17 13:08:29,710] Trial 96 finished with value: 12.047740667880191 and parameters: {'vizinhos': 19, 'pesos': 'uniform', 'parametro_potencia': 4.612553392282175}. Best is trial 57 with value: 12.019677704294402.\n",
      "[I 2024-11-17 13:08:30,690] Trial 97 finished with value: 12.022063862865531 and parameters: {'vizinhos': 20, 'pesos': 'uniform', 'parametro_potencia': 5.29817062772243}. Best is trial 57 with value: 12.019677704294402.\n",
      "[I 2024-11-17 13:08:31,822] Trial 98 finished with value: 12.041918075301309 and parameters: {'vizinhos': 19, 'pesos': 'uniform', 'parametro_potencia': 5.525142918371208}. Best is trial 57 with value: 12.019677704294402.\n",
      "[I 2024-11-17 13:08:32,812] Trial 99 finished with value: 12.028469305966473 and parameters: {'vizinhos': 20, 'pesos': 'uniform', 'parametro_potencia': 4.170858163692881}. Best is trial 57 with value: 12.019677704294402.\n",
      "[I 2024-11-17 13:08:33,806] Trial 100 finished with value: 12.025927300823192 and parameters: {'vizinhos': 20, 'pesos': 'uniform', 'parametro_potencia': 5.808276105696772}. Best is trial 57 with value: 12.019677704294402.\n",
      "[I 2024-11-17 13:08:34,820] Trial 101 finished with value: 12.047102031315914 and parameters: {'vizinhos': 19, 'pesos': 'uniform', 'parametro_potencia': 4.820969186743893}. Best is trial 57 with value: 12.019677704294402.\n",
      "[I 2024-11-17 13:08:35,840] Trial 102 finished with value: 12.061021649825882 and parameters: {'vizinhos': 18, 'pesos': 'uniform', 'parametro_potencia': 5.117795149626403}. Best is trial 57 with value: 12.019677704294402.\n",
      "[I 2024-11-17 13:08:36,886] Trial 103 finished with value: 12.021840516002541 and parameters: {'vizinhos': 20, 'pesos': 'uniform', 'parametro_potencia': 5.259451221728884}. Best is trial 57 with value: 12.019677704294402.\n",
      "[I 2024-11-17 13:08:37,870] Trial 104 finished with value: 12.021296302210668 and parameters: {'vizinhos': 20, 'pesos': 'uniform', 'parametro_potencia': 4.673285461105137}. Best is trial 57 with value: 12.019677704294402.\n",
      "[I 2024-11-17 13:08:38,944] Trial 105 finished with value: 12.046826039218171 and parameters: {'vizinhos': 19, 'pesos': 'uniform', 'parametro_potencia': 4.721017675986225}. Best is trial 57 with value: 12.019677704294402.\n",
      "[I 2024-11-17 13:08:39,968] Trial 106 finished with value: 12.02483425258741 and parameters: {'vizinhos': 20, 'pesos': 'uniform', 'parametro_potencia': 5.03976280650929}. Best is trial 57 with value: 12.019677704294402.\n",
      "[I 2024-11-17 13:08:40,983] Trial 107 finished with value: 12.025276214102801 and parameters: {'vizinhos': 20, 'pesos': 'uniform', 'parametro_potencia': 4.331337576056899}. Best is trial 57 with value: 12.019677704294402.\n",
      "[I 2024-11-17 13:08:42,023] Trial 108 finished with value: 12.047692580809144 and parameters: {'vizinhos': 19, 'pesos': 'uniform', 'parametro_potencia': 4.574655203465032}. Best is trial 57 with value: 12.019677704294402.\n",
      "[I 2024-11-17 13:08:43,006] Trial 109 finished with value: 12.021786551753891 and parameters: {'vizinhos': 20, 'pesos': 'uniform', 'parametro_potencia': 4.849374819595932}. Best is trial 57 with value: 12.019677704294402.\n",
      "[I 2024-11-17 13:08:43,997] Trial 110 finished with value: 12.048194549409413 and parameters: {'vizinhos': 19, 'pesos': 'uniform', 'parametro_potencia': 4.934984543674195}. Best is trial 57 with value: 12.019677704294402.\n",
      "[I 2024-11-17 13:08:45,019] Trial 111 finished with value: 12.030678782301893 and parameters: {'vizinhos': 20, 'pesos': 'uniform', 'parametro_potencia': 3.9246281732522865}. Best is trial 57 with value: 12.019677704294402.\n",
      "[I 2024-11-17 13:08:46,020] Trial 112 finished with value: 12.041582094098224 and parameters: {'vizinhos': 20, 'pesos': 'distance', 'parametro_potencia': 4.6479867722308335}. Best is trial 57 with value: 12.019677704294402.\n",
      "[I 2024-11-17 13:08:47,042] Trial 113 finished with value: 12.021800119594923 and parameters: {'vizinhos': 20, 'pesos': 'uniform', 'parametro_potencia': 4.843108095469665}. Best is trial 57 with value: 12.019677704294402.\n",
      "[I 2024-11-17 13:08:48,027] Trial 114 finished with value: 12.021634675572749 and parameters: {'vizinhos': 20, 'pesos': 'uniform', 'parametro_potencia': 4.839049126569925}. Best is trial 57 with value: 12.019677704294402.\n",
      "[I 2024-11-17 13:08:49,048] Trial 115 finished with value: 12.043341978637564 and parameters: {'vizinhos': 19, 'pesos': 'uniform', 'parametro_potencia': 4.24408838862954}. Best is trial 57 with value: 12.019677704294402.\n",
      "[I 2024-11-17 13:08:50,059] Trial 116 finished with value: 12.024346088738561 and parameters: {'vizinhos': 20, 'pesos': 'uniform', 'parametro_potencia': 4.441712280797475}. Best is trial 57 with value: 12.019677704294402.\n",
      "[I 2024-11-17 13:08:51,153] Trial 117 finished with value: 12.035321246271518 and parameters: {'vizinhos': 20, 'pesos': 'uniform', 'parametro_potencia': 2.4683752786509423}. Best is trial 57 with value: 12.019677704294402.\n",
      "[I 2024-11-17 13:08:52,180] Trial 118 finished with value: 12.047879817596947 and parameters: {'vizinhos': 19, 'pesos': 'uniform', 'parametro_potencia': 4.8418083349076735}. Best is trial 57 with value: 12.019677704294402.\n",
      "[I 2024-11-17 13:08:53,159] Trial 119 finished with value: 12.045067901933702 and parameters: {'vizinhos': 19, 'pesos': 'uniform', 'parametro_potencia': 5.096915074120746}. Best is trial 57 with value: 12.019677704294402.\n",
      "[I 2024-11-17 13:08:54,204] Trial 120 finished with value: 12.024990859804369 and parameters: {'vizinhos': 20, 'pesos': 'uniform', 'parametro_potencia': 5.417018333470556}. Best is trial 57 with value: 12.019677704294402.\n",
      "[I 2024-11-17 13:08:55,154] Trial 121 finished with value: 12.146570387553641 and parameters: {'vizinhos': 14, 'pesos': 'uniform', 'parametro_potencia': 4.626325574288736}. Best is trial 57 with value: 12.019677704294402.\n",
      "[I 2024-11-17 13:08:56,162] Trial 122 finished with value: 12.063170811063806 and parameters: {'vizinhos': 18, 'pesos': 'uniform', 'parametro_potencia': 4.757429370098553}. Best is trial 57 with value: 12.019677704294402.\n",
      "[I 2024-11-17 13:08:57,268] Trial 123 finished with value: 12.020279769749715 and parameters: {'vizinhos': 20, 'pesos': 'uniform', 'parametro_potencia': 4.8930025599427065}. Best is trial 57 with value: 12.019677704294402.\n",
      "[I 2024-11-17 13:08:58,312] Trial 124 finished with value: 12.023762822728582 and parameters: {'vizinhos': 20, 'pesos': 'uniform', 'parametro_potencia': 4.411732022423723}. Best is trial 57 with value: 12.019677704294402.\n",
      "[I 2024-11-17 13:08:59,336] Trial 125 finished with value: 12.022657872799812 and parameters: {'vizinhos': 20, 'pesos': 'uniform', 'parametro_potencia': 5.234108902033761}. Best is trial 57 with value: 12.019677704294402.\n",
      "[I 2024-11-17 13:09:00,341] Trial 126 finished with value: 12.047229814211324 and parameters: {'vizinhos': 19, 'pesos': 'uniform', 'parametro_potencia': 5.064291434985206}. Best is trial 57 with value: 12.019677704294402.\n",
      "[I 2024-11-17 13:09:01,371] Trial 127 finished with value: 12.021935989645467 and parameters: {'vizinhos': 20, 'pesos': 'uniform', 'parametro_potencia': 4.533540403554103}. Best is trial 57 with value: 12.019677704294402.\n",
      "[I 2024-11-17 13:09:02,233] Trial 128 finished with value: 12.675521812339364 and parameters: {'vizinhos': 6, 'pesos': 'uniform', 'parametro_potencia': 5.644974641187082}. Best is trial 57 with value: 12.019677704294402.\n",
      "[I 2024-11-17 13:09:03,238] Trial 129 finished with value: 12.048351407110482 and parameters: {'vizinhos': 19, 'pesos': 'uniform', 'parametro_potencia': 4.7656495526546285}. Best is trial 57 with value: 12.019677704294402.\n",
      "[I 2024-11-17 13:09:04,204] Trial 130 finished with value: 12.297112936766473 and parameters: {'vizinhos': 10, 'pesos': 'uniform', 'parametro_potencia': 5.057513334296117}. Best is trial 57 with value: 12.019677704294402.\n",
      "[I 2024-11-17 13:09:05,210] Trial 131 finished with value: 12.041476040655514 and parameters: {'vizinhos': 20, 'pesos': 'distance', 'parametro_potencia': 5.357603885325154}. Best is trial 57 with value: 12.019677704294402.\n",
      "[I 2024-11-17 13:09:06,225] Trial 132 finished with value: 12.049164063783193 and parameters: {'vizinhos': 19, 'pesos': 'uniform', 'parametro_potencia': 4.898181270648436}. Best is trial 57 with value: 12.019677704294402.\n",
      "[I 2024-11-17 13:09:07,239] Trial 133 finished with value: 12.022444522156938 and parameters: {'vizinhos': 20, 'pesos': 'uniform', 'parametro_potencia': 4.545390432958551}. Best is trial 57 with value: 12.019677704294402.\n",
      "[I 2024-11-17 13:09:08,252] Trial 134 finished with value: 12.026192229543256 and parameters: {'vizinhos': 20, 'pesos': 'uniform', 'parametro_potencia': 4.287066890020118}. Best is trial 57 with value: 12.019677704294402.\n",
      "[I 2024-11-17 13:09:09,379] Trial 135 finished with value: 12.025739566397329 and parameters: {'vizinhos': 20, 'pesos': 'uniform', 'parametro_potencia': 4.086213918825697}. Best is trial 57 with value: 12.019677704294402.\n",
      "[I 2024-11-17 13:09:10,427] Trial 136 finished with value: 12.026109812968134 and parameters: {'vizinhos': 20, 'pesos': 'uniform', 'parametro_potencia': 4.475197749110508}. Best is trial 57 with value: 12.019677704294402.\n",
      "[I 2024-11-17 13:09:11,426] Trial 137 finished with value: 12.01797041451045 and parameters: {'vizinhos': 20, 'pesos': 'uniform', 'parametro_potencia': 4.7062239146607645}. Best is trial 137 with value: 12.01797041451045.\n",
      "[I 2024-11-17 13:09:12,480] Trial 138 finished with value: 12.04737880682827 and parameters: {'vizinhos': 19, 'pesos': 'uniform', 'parametro_potencia': 4.681966512636213}. Best is trial 137 with value: 12.01797041451045.\n",
      "[I 2024-11-17 13:09:13,462] Trial 139 finished with value: 12.023708340300237 and parameters: {'vizinhos': 20, 'pesos': 'uniform', 'parametro_potencia': 5.209009888544512}. Best is trial 137 with value: 12.01797041451045.\n",
      "[I 2024-11-17 13:09:14,462] Trial 140 finished with value: 12.027191430451499 and parameters: {'vizinhos': 20, 'pesos': 'uniform', 'parametro_potencia': 5.495026460556141}. Best is trial 137 with value: 12.01797041451045.\n",
      "[I 2024-11-17 13:09:15,467] Trial 141 finished with value: 12.048385844946553 and parameters: {'vizinhos': 19, 'pesos': 'uniform', 'parametro_potencia': 4.901773736948356}. Best is trial 137 with value: 12.01797041451045.\n",
      "[I 2024-11-17 13:09:16,469] Trial 142 finished with value: 12.026718521297273 and parameters: {'vizinhos': 20, 'pesos': 'uniform', 'parametro_potencia': 5.7468072011724365}. Best is trial 137 with value: 12.01797041451045.\n",
      "[I 2024-11-17 13:09:17,519] Trial 143 finished with value: 12.018884382121945 and parameters: {'vizinhos': 20, 'pesos': 'uniform', 'parametro_potencia': 4.720229864732436}. Best is trial 137 with value: 12.01797041451045.\n",
      "[I 2024-11-17 13:09:18,505] Trial 144 finished with value: 12.020047418683413 and parameters: {'vizinhos': 20, 'pesos': 'uniform', 'parametro_potencia': 4.760037002481512}. Best is trial 137 with value: 12.01797041451045.\n",
      "[I 2024-11-17 13:09:19,607] Trial 145 finished with value: 12.01811955631954 and parameters: {'vizinhos': 20, 'pesos': 'uniform', 'parametro_potencia': 4.709673300002715}. Best is trial 137 with value: 12.01797041451045.\n",
      "[I 2024-11-17 13:09:20,615] Trial 146 finished with value: 12.020144151682107 and parameters: {'vizinhos': 20, 'pesos': 'uniform', 'parametro_potencia': 4.694586136271953}. Best is trial 137 with value: 12.01797041451045.\n",
      "[I 2024-11-17 13:09:21,676] Trial 147 finished with value: 12.047393161753249 and parameters: {'vizinhos': 19, 'pesos': 'uniform', 'parametro_potencia': 4.681131045814397}. Best is trial 137 with value: 12.01797041451045.\n",
      "[I 2024-11-17 13:09:22,668] Trial 148 finished with value: 12.023053187552593 and parameters: {'vizinhos': 20, 'pesos': 'uniform', 'parametro_potencia': 4.385477998171828}. Best is trial 137 with value: 12.01797041451045.\n",
      "[I 2024-11-17 13:09:23,665] Trial 149 finished with value: 12.042164105559507 and parameters: {'vizinhos': 19, 'pesos': 'uniform', 'parametro_potencia': 4.175777450563798}. Best is trial 137 with value: 12.01797041451045.\n",
      "[I 2024-11-17 13:09:24,719] Trial 150 finished with value: 12.021253663824087 and parameters: {'vizinhos': 20, 'pesos': 'uniform', 'parametro_potencia': 4.6867902170731925}. Best is trial 137 with value: 12.01797041451045.\n",
      "[I 2024-11-17 13:09:25,820] Trial 151 finished with value: 12.019785120320105 and parameters: {'vizinhos': 20, 'pesos': 'uniform', 'parametro_potencia': 4.6003352255239705}. Best is trial 137 with value: 12.01797041451045.\n",
      "[I 2024-11-17 13:09:26,914] Trial 152 finished with value: 12.047828503399785 and parameters: {'vizinhos': 19, 'pesos': 'uniform', 'parametro_potencia': 4.592913449619355}. Best is trial 137 with value: 12.01797041451045.\n",
      "[I 2024-11-17 13:09:27,977] Trial 153 finished with value: 12.024353757786061 and parameters: {'vizinhos': 20, 'pesos': 'uniform', 'parametro_potencia': 4.375095927339183}. Best is trial 137 with value: 12.01797041451045.\n",
      "[I 2024-11-17 13:09:28,966] Trial 154 finished with value: 12.017846492951351 and parameters: {'vizinhos': 20, 'pesos': 'uniform', 'parametro_potencia': 4.703707932078681}. Best is trial 154 with value: 12.017846492951351.\n",
      "[I 2024-11-17 13:09:30,095] Trial 155 finished with value: 12.021074059451944 and parameters: {'vizinhos': 20, 'pesos': 'uniform', 'parametro_potencia': 4.669289960923556}. Best is trial 154 with value: 12.017846492951351.\n",
      "[I 2024-11-17 13:09:31,105] Trial 156 finished with value: 12.021309506938493 and parameters: {'vizinhos': 20, 'pesos': 'uniform', 'parametro_potencia': 4.689618234258707}. Best is trial 154 with value: 12.017846492951351.\n",
      "[I 2024-11-17 13:09:32,216] Trial 157 finished with value: 12.025273256267072 and parameters: {'vizinhos': 20, 'pesos': 'uniform', 'parametro_potencia': 4.495205347129398}. Best is trial 154 with value: 12.017846492951351.\n",
      "[I 2024-11-17 13:09:33,249] Trial 158 finished with value: 12.199704378982467 and parameters: {'vizinhos': 12, 'pesos': 'uniform', 'parametro_potencia': 4.66762439917222}. Best is trial 154 with value: 12.017846492951351.\n",
      "[I 2024-11-17 13:09:34,252] Trial 159 finished with value: 12.043510401165404 and parameters: {'vizinhos': 19, 'pesos': 'uniform', 'parametro_potencia': 4.241478323319028}. Best is trial 154 with value: 12.017846492951351.\n",
      "[I 2024-11-17 13:09:35,388] Trial 160 finished with value: 12.018020249067728 and parameters: {'vizinhos': 20, 'pesos': 'uniform', 'parametro_potencia': 4.711847352948879}. Best is trial 154 with value: 12.017846492951351.\n",
      "[I 2024-11-17 13:09:36,409] Trial 161 finished with value: 12.044144459856318 and parameters: {'vizinhos': 20, 'pesos': 'distance', 'parametro_potencia': 5.037459935614693}. Best is trial 154 with value: 12.017846492951351.\n",
      "[I 2024-11-17 13:09:37,458] Trial 162 finished with value: 12.044826841331735 and parameters: {'vizinhos': 19, 'pesos': 'uniform', 'parametro_potencia': 4.3333440046014875}. Best is trial 154 with value: 12.017846492951351.\n",
      "[I 2024-11-17 13:09:38,501] Trial 163 finished with value: 12.017840714433753 and parameters: {'vizinhos': 20, 'pesos': 'uniform', 'parametro_potencia': 4.707739692974665}. Best is trial 163 with value: 12.017840714433753.\n",
      "[I 2024-11-17 13:09:39,493] Trial 164 finished with value: 12.020339250155917 and parameters: {'vizinhos': 20, 'pesos': 'uniform', 'parametro_potencia': 4.609698019957472}. Best is trial 163 with value: 12.017840714433753.\n",
      "[I 2024-11-17 13:09:40,533] Trial 165 finished with value: 12.023215837922137 and parameters: {'vizinhos': 20, 'pesos': 'uniform', 'parametro_potencia': 4.400903726933054}. Best is trial 163 with value: 12.017840714433753.\n",
      "[I 2024-11-17 13:09:41,555] Trial 166 finished with value: 12.022313806263133 and parameters: {'vizinhos': 20, 'pesos': 'uniform', 'parametro_potencia': 4.549318642784469}. Best is trial 163 with value: 12.017840714433753.\n",
      "[I 2024-11-17 13:09:42,589] Trial 167 finished with value: 12.021399649307822 and parameters: {'vizinhos': 20, 'pesos': 'uniform', 'parametro_potencia': 4.993773217587544}. Best is trial 163 with value: 12.017840714433753.\n",
      "[I 2024-11-17 13:09:43,648] Trial 168 finished with value: 12.046643649260433 and parameters: {'vizinhos': 19, 'pesos': 'uniform', 'parametro_potencia': 4.513861773154403}. Best is trial 163 with value: 12.017840714433753.\n",
      "[I 2024-11-17 13:09:44,677] Trial 169 finished with value: 12.046509575741862 and parameters: {'vizinhos': 19, 'pesos': 'uniform', 'parametro_potencia': 4.8063690573560605}. Best is trial 163 with value: 12.017840714433753.\n",
      "[I 2024-11-17 13:09:45,702] Trial 170 finished with value: 12.01968710041678 and parameters: {'vizinhos': 20, 'pesos': 'uniform', 'parametro_potencia': 4.739357558168596}. Best is trial 163 with value: 12.017840714433753.\n",
      "[I 2024-11-17 13:09:46,701] Trial 171 finished with value: 12.0262034663745 and parameters: {'vizinhos': 20, 'pesos': 'uniform', 'parametro_potencia': 4.079758176563254}. Best is trial 163 with value: 12.017840714433753.\n",
      "[I 2024-11-17 13:09:47,772] Trial 172 finished with value: 12.021596256435476 and parameters: {'vizinhos': 20, 'pesos': 'uniform', 'parametro_potencia': 4.938333524424137}. Best is trial 163 with value: 12.017840714433753.\n",
      "[I 2024-11-17 13:09:48,782] Trial 173 finished with value: 12.019478564543281 and parameters: {'vizinhos': 20, 'pesos': 'uniform', 'parametro_potencia': 4.75374276387824}. Best is trial 163 with value: 12.017840714433753.\n",
      "[I 2024-11-17 13:09:49,805] Trial 174 finished with value: 12.020075917557422 and parameters: {'vizinhos': 20, 'pesos': 'uniform', 'parametro_potencia': 4.761938641984732}. Best is trial 163 with value: 12.017840714433753.\n",
      "[I 2024-11-17 13:09:50,817] Trial 175 finished with value: 12.019650720627743 and parameters: {'vizinhos': 20, 'pesos': 'uniform', 'parametro_potencia': 4.790262311639891}. Best is trial 163 with value: 12.017840714433753.\n",
      "[I 2024-11-17 13:09:51,862] Trial 176 finished with value: 12.02454254829248 and parameters: {'vizinhos': 20, 'pesos': 'uniform', 'parametro_potencia': 5.05020030220745}. Best is trial 163 with value: 12.017840714433753.\n",
      "[I 2024-11-17 13:09:52,869] Trial 177 finished with value: 12.019866019828367 and parameters: {'vizinhos': 20, 'pesos': 'uniform', 'parametro_potencia': 4.7850192497642485}. Best is trial 163 with value: 12.017840714433753.\n",
      "[I 2024-11-17 13:09:53,957] Trial 178 finished with value: 12.045677022677507 and parameters: {'vizinhos': 19, 'pesos': 'uniform', 'parametro_potencia': 4.81423929622631}. Best is trial 163 with value: 12.017840714433753.\n",
      "[I 2024-11-17 13:09:55,006] Trial 179 finished with value: 12.024755182599073 and parameters: {'vizinhos': 20, 'pesos': 'uniform', 'parametro_potencia': 5.1440691901948545}. Best is trial 163 with value: 12.017840714433753.\n",
      "[I 2024-11-17 13:09:56,013] Trial 180 finished with value: 12.047845182550855 and parameters: {'vizinhos': 19, 'pesos': 'uniform', 'parametro_potencia': 4.952132986809102}. Best is trial 163 with value: 12.017840714433753.\n",
      "[I 2024-11-17 13:09:57,066] Trial 181 finished with value: 12.019645164743247 and parameters: {'vizinhos': 20, 'pesos': 'uniform', 'parametro_potencia': 4.7937646420811495}. Best is trial 163 with value: 12.017840714433753.\n",
      "[I 2024-11-17 13:09:58,259] Trial 182 finished with value: 12.024196266163797 and parameters: {'vizinhos': 20, 'pesos': 'uniform', 'parametro_potencia': 4.511833950448541}. Best is trial 163 with value: 12.017840714433753.\n",
      "[I 2024-11-17 13:09:59,298] Trial 183 finished with value: 12.021159776921227 and parameters: {'vizinhos': 20, 'pesos': 'uniform', 'parametro_potencia': 4.7973993278737}. Best is trial 163 with value: 12.017840714433753.\n",
      "[I 2024-11-17 13:10:00,308] Trial 184 finished with value: 12.021559925451488 and parameters: {'vizinhos': 20, 'pesos': 'uniform', 'parametro_potencia': 4.837702820875955}. Best is trial 163 with value: 12.017840714433753.\n",
      "[I 2024-11-17 13:10:01,419] Trial 185 finished with value: 12.023224470597912 and parameters: {'vizinhos': 20, 'pesos': 'uniform', 'parametro_potencia': 5.015595686366276}. Best is trial 163 with value: 12.017840714433753.\n",
      "[I 2024-11-17 13:10:02,451] Trial 186 finished with value: 12.046253634687403 and parameters: {'vizinhos': 19, 'pesos': 'uniform', 'parametro_potencia': 4.504720856217248}. Best is trial 163 with value: 12.017840714433753.\n",
      "[I 2024-11-17 13:10:03,511] Trial 187 finished with value: 12.019888594087874 and parameters: {'vizinhos': 20, 'pesos': 'uniform', 'parametro_potencia': 4.7363029577889}. Best is trial 163 with value: 12.017840714433753.\n",
      "[I 2024-11-17 13:10:04,502] Trial 188 finished with value: 12.01987709458441 and parameters: {'vizinhos': 20, 'pesos': 'uniform', 'parametro_potencia': 4.737210593061582}. Best is trial 163 with value: 12.017840714433753.\n",
      "[I 2024-11-17 13:10:05,528] Trial 189 finished with value: 12.023601892488836 and parameters: {'vizinhos': 20, 'pesos': 'uniform', 'parametro_potencia': 4.368016459981154}. Best is trial 163 with value: 12.017840714433753.\n",
      "[I 2024-11-17 13:10:06,535] Trial 190 finished with value: 12.047864194869238 and parameters: {'vizinhos': 19, 'pesos': 'uniform', 'parametro_potencia': 4.730894760502676}. Best is trial 163 with value: 12.017840714433753.\n",
      "[I 2024-11-17 13:10:07,631] Trial 191 finished with value: 12.042149910895283 and parameters: {'vizinhos': 20, 'pesos': 'distance', 'parametro_potencia': 4.5548406376603925}. Best is trial 163 with value: 12.017840714433753.\n",
      "[I 2024-11-17 13:10:08,683] Trial 192 finished with value: 12.026429302059006 and parameters: {'vizinhos': 20, 'pesos': 'uniform', 'parametro_potencia': 5.106964035360794}. Best is trial 163 with value: 12.017840714433753.\n",
      "[I 2024-11-17 13:10:09,676] Trial 193 finished with value: 12.020141140818073 and parameters: {'vizinhos': 20, 'pesos': 'uniform', 'parametro_potencia': 4.728501219522299}. Best is trial 163 with value: 12.017840714433753.\n",
      "[I 2024-11-17 13:10:10,856] Trial 194 finished with value: 12.01995897928182 and parameters: {'vizinhos': 20, 'pesos': 'uniform', 'parametro_potencia': 4.789683311851869}. Best is trial 163 with value: 12.017840714433753.\n",
      "[I 2024-11-17 13:10:11,746] Trial 195 finished with value: 12.425275953994847 and parameters: {'vizinhos': 8, 'pesos': 'uniform', 'parametro_potencia': 4.906059308365663}. Best is trial 163 with value: 12.017840714433753.\n",
      "[I 2024-11-17 13:10:12,743] Trial 196 finished with value: 12.01980292719443 and parameters: {'vizinhos': 20, 'pesos': 'uniform', 'parametro_potencia': 4.790681043736763}. Best is trial 163 with value: 12.017840714433753.\n",
      "[I 2024-11-17 13:10:13,776] Trial 197 finished with value: 12.021042524798963 and parameters: {'vizinhos': 20, 'pesos': 'uniform', 'parametro_potencia': 4.563978385516131}. Best is trial 163 with value: 12.017840714433753.\n",
      "[I 2024-11-17 13:10:14,757] Trial 198 finished with value: 12.047081262019802 and parameters: {'vizinhos': 19, 'pesos': 'uniform', 'parametro_potencia': 5.005800419521604}. Best is trial 163 with value: 12.017840714433753.\n",
      "[I 2024-11-17 13:10:15,846] Trial 199 finished with value: 12.023215837922137 and parameters: {'vizinhos': 20, 'pesos': 'uniform', 'parametro_potencia': 4.400865834146311}. Best is trial 163 with value: 12.017840714433753.\n",
      "[I 2024-11-17 13:10:16,867] Trial 200 finished with value: 12.024654263908953 and parameters: {'vizinhos': 20, 'pesos': 'uniform', 'parametro_potencia': 5.186771306382403}. Best is trial 163 with value: 12.017840714433753.\n",
      "[I 2024-11-17 13:10:17,919] Trial 201 finished with value: 12.047349154061727 and parameters: {'vizinhos': 19, 'pesos': 'uniform', 'parametro_potencia': 4.796941109855242}. Best is trial 163 with value: 12.017840714433753.\n"
     ]
    }
   ],
   "source": [
    "NUM_TENTATIVAS = 200\n",
    "\n",
    "objeto_de_estudo.optimize(funcao_objetivo_parcial, n_trials=NUM_TENTATIVAS)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 34,
   "id": "7c7b3e12-7a3a-40aa-81da-cfcf947c8b69",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Número do melhor trial: 163\n",
      "Parâmetros do melhor trial: {'vizinhos': 20, 'pesos': 'uniform', 'parametro_potencia': 4.707739692974665}\n"
     ]
    }
   ],
   "source": [
    "melhor_trial = objeto_de_estudo.best_trial\n",
    "\n",
    "print(f\"Número do melhor trial: {melhor_trial.number}\")\n",
    "print(f\"Parâmetros do melhor trial: {melhor_trial.params}\")"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "6e719e73-af00-4b23-9cef-5fb6042d19e1",
   "metadata": {},
   "source": [
    "### Estimando a performance do modelo KNN"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 35,
   "id": "dc685337-a084-47c5-8c2f-66d334d29c0e",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "As métricas foram: [-12.96641637 -14.28269458 -12.98670304 -13.77526908 -13.27256135\n",
      " -13.74230308 -14.76237202 -14.68992076 -15.53347737 -15.66091959\n",
      " -16.18437657 -16.48036195 -14.3541207  -15.12470355 -13.64973125\n",
      " -14.29325765 -14.15535944 -13.66711562 -13.43344439 -12.52092496\n",
      " -12.25026824 -11.40833176 -11.18876608 -10.90721526 -11.05124348\n",
      " -10.64862012  -9.62997693  -9.96292192  -8.84151588  -9.16327958\n",
      "  -8.77669209  -8.35959764  -8.29322372  -8.01413593  -8.38537479\n",
      "  -8.42896354  -8.55851447  -8.17734196  -8.34457865  -7.53583963]\n",
      "\n",
      "A média das métricas é de: 11.836560874518355\n"
     ]
    }
   ],
   "source": [
    "from sklearn.model_selection import cross_val_score\n",
    "\n",
    "NUM_FOLDS = 40\n",
    "SEMENTE_ALEATORIA = 20404\n",
    "modelo_ad = cria_instancia_modelo(melhor_trial)\n",
    "\n",
    "metricas = cross_val_score(\n",
    "    modelo_ad,    #instancia\n",
    "    X,            #dados de atributos\n",
    "    y,            #dados de target\n",
    "    cv=NUM_FOLDS, #número de folds\n",
    "    scoring=\"neg_root_mean_squared_error\", #quanto maior, melhor pelo scikit\n",
    ")\n",
    "\n",
    "print(\"As métricas foram:\", metricas)\n",
    "print()\n",
    "print(\"A média das métricas é de:\", np.abs(metricas.mean()))"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "710679f2-4164-45cd-a95e-740af360faad",
   "metadata": {},
   "source": [
    "### Conclusão\n",
    "\n",
    "<p style=\"text-align:justify;\"> Ao encontrar o RMSE do baseline, temos um ponto de partida, ou seja, sabe-se que qualquer modelo que apresente um RMSE, a métrica de performance que escolhemos utilizar,  maior que esse valor não nos gera um bom modelo. A partir desse ponto, começou-se o estudo para selecionar atributos, o que utilizamos a técnica de seleção de atributos pelo fator de inflação de variância (VIF), assim como escolher o melhor conjunto de hiperparâmetros pelo optuna. Ademais, a seleção de melhores atributos foi realizada de acordo com os dois modelos avaliados: floresta aleatória e KNN. Com a métrica de performande de cada um desses modelos, pode-se observar o esperado: os resultados são muito próximos, até próximo do próprio baseline, isso significa que os dados que estamos lidando são bastante difíceis de serem preditos e que há bastante estudo para ser realizado ainda, desde acrescentar mais atributos acerca do paciente, até encontrar novos modelos que consigam lidar com a variabilidade muito sucinta sobre a saúde de um paciente. Contudo, precisou-se escolher um modelo e o que ainda apresentou o menor RMSE foi o regressor de floresta aleatória."
   ]
  },
  {
   "cell_type": "markdown",
   "id": "0ad8df15-77a9-4cfd-85e8-a7eaae4ef8ca",
   "metadata": {},
   "source": [
    "### Referências"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "b721b3c5-3e43-438c-981b-8afefe06d23b",
   "metadata": {},
   "source": [
    "<p style=\"text-align:justify;\">[1] Nguyen, Bastien, Christopher Fong, Anisha Luthra, Shaleigh A. Smith, Renzo G. DiNatale, Subhiksha Nandakumar, Henry Walch, et al. “Genomic Characterization of Metastatic Patterns from Prospective Clinical Sequencing of 25,000 Patients”. Cell 185, nº 3 (3 de fevereiro de 2022): 563-575.e11. https://doi.org/10.1016/j.cell.2022.01.003.\n",
    "<p style=\"text-align:justify;\">[2] scikit-learn. “6.3. Preprocessing Data”. Acesso em 9 de outubro de 2024. https://scikit-learn/stable/modules/preprocessing.html.\n",
    "<p style=\"text-align:justify;\">[3] “ATP-203 1.1 - Tratamento de dados”. Acesso em 9 de outubro de 2024. \n",
    "<p style=\"text-align:justify;\">[4] \"ATP-203 2.1 - Aprendizado de máquina, k-NN e métricas\". Acesso em 16 de novembro de 2024.\n",
    "<p style=\"text-align:justify;\">[5] “ATP-203 5.1 - Floresta aleatória”. Acesso em 9 de outubro de 2024. \n",
    "<p style=\"text-align:justify;\">[6] \"ATP-203 6.1 - Otimização de hiperparâmetros com optuna\". Acesso em 16 de novembro de 2024.\n",
    "<p style=\"text-align:justify;\">[7] \"ATP-203 7.1 - Seleção de atributos\". Acesso em 16 de novembro de 2024.\n",
    "<p style=\"text-align:justify;\">[8] \"ATP-203 9.1 - Classificação binária\". Acesso em 10 de novembro de 2024. \n"
   ]
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3 (ipykernel)",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.12.3"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 5
}
